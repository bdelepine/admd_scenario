<!DOCTYPE html><html><head><title>Scenario_DA</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style>.small-caps{text-transform:uppercase;font-size:70%;letter-spacing:.075em}#backstage .panel h2{margin:0}#backstage .panel h2 button{text-align:left;background:none;border:none;width:100%;font-weight:400;text-transform:uppercase;font-size:70%;letter-spacing:.075em;font-size:11px;padding:0 8px}#backstage .panel h2 button:before{content:"\25BA";display:inline-block;width:1.25em}#backstage .panel h2 button:hover{color:#495057}#backstage .panel.open h2 button:before{content:"\25BC"}
#backstage table.history td.actions{width:2.5em}#backstage table.history td.go{border-right:1px solid #000}
#backstage ul.tabs{list-style:none;margin:8px;padding:0;display:flex;border:1px solid #000;font-size:12px}#backstage ul.tabs li{flex-grow:1;border-right:1px solid #000;text-align:center}#backstage ul.tabs li:last-child{border-right:none}#backstage ul.tabs li button{color:#000;text-decoration:none;display:block;width:100%;height:28px;padding:8px;border:none;border-radius:0}#backstage ul.tabs li button.active{background:#000;color:#dee2e6}#backstage .tab-content{max-height:calc(100vh - $backstage-tab-height);overflow:auto}
.small-caps{text-transform:uppercase;font-size:70%;letter-spacing:.075em}body.backstage-visible #backdrop{justify-content:flex-start;max-width:67vw}#backstage{position:fixed;top:0;right:0;bottom:0;width:33vw;max-height:100vh;font-size:18px;background:#dee2e6;color:#000;transform:translateX(100%);box-shadow:inset 2px 0 3px rgba(0,0,0,.25);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu Cantarell,Helvetica Neue,sans-serif;font-size:80%}#backstage:before{content:"";position:absolute;z-index:2;top:calc(50% - 25px);right:calc(100% - 4px);height:50px;width:4px;background:#dee2e6}@media screen and (max-width:425px){#backstage{width:calc(100vw - 25px)}}#backstage.open{transform:none}#backstage .toggle-visibility{position:absolute;z-index:1;top:calc(50% - 25px);right:100%;width:25px;height:50px;padding:0;background:#dee2e6;color:#000;border:none;border-top-left-radius:25px;border-bottom-left-radius:25px;border-top-right-radius:0;border-bottom-right-radius:0;box-shadow:inset 2px 0 3px rgba(0,0,0,.25);font-size:18px}#backstage button{color:#000;background:transparent;padding:8px;border-radius:16px;border:1px solid #000}#backstage button:hover{background:#e9ecef}#backstage p{padding:0 8px}#backstage li,#backstage p,#backstage td{font-size:12px}#backstage input,#backstage select{color:#000;background:transparent;border:1px solid #000;padding:8px}#backstage table{background:transparent;table-layout:fixed;border-collapse:collapse;width:calc(100% - 16px);margin:8px}#backstage th{text-align:left}#backstage td{position:relative;border:1px solid #000;padding:8px;vertical-align:top}#backstage td:first-child{border-left:none}#backstage td:last-child{border-right:none}#backstage td button,#backstage td input{background:none;border:none;border-radius:0;position:absolute;top:0;left:0;bottom:0;width:100%;padding:8px}#backstage textarea{background:transparent;border:1px solid #000;color:#000;padding:8px;width:100%;height:7.75em}#backstage .block{display:block;margin:8px;width:calc(100% - 16px)}#backstage .disabled{color:#868e96}#backstage .indented-input{margin-left:calc(10em + 8px);font-size:12px}#backstage .input-group{display:flex;align-items:center}#backstage .input-group label:first-child{text-align:right;margin-right:8px;width:10em}#backstage .input-group input,#backstage .input-group select{flex-grow:1}#backstage .segmented-button{display:flex}#backstage .segmented-button button{border-left:none;border-radius:0;margin:0;flex-grow:1}#backstage .segmented-button button:first-child{border-left:1px solid #000;border-top-left-radius:16px;border-bottom-left-radius:16px}#backstage .segmented-button button:last-child{border-top-right-radius:16px;border-bottom-right-radius:16px}#backstage .segmented-button .fixed{flex-grow:0;min-width:24px}#backstage .tab-content{max-height:calc(100vh - 28px);overflow:auto}
.fade-in{opacity:0;animation:fade-in 1s ease-out forwards}.fade-out{animation:fade-in 1s ease-out reverse forwards}.skip-animation{animation-delay:0s!important}@keyframes fade-in{0%{opacity:0}to{opacity:1}}
#page .warnings{list-style-type:none;padding-left:0;margin-left:0}
.small-caps{text-transform:uppercase;font-size:70%;letter-spacing:.075em}#backdrop{min-height:100vh;align-items:center}#backdrop,#page{display:flex;justify-content:center}#page{flex-direction:column;width:40em;min-height:calc(100vh - 2em);max-width:calc(100vw - 2em);line-height:150%;margin:1em;padding:4em 4em 2em;position:relative}#page article{flex-grow:1;display:flex}#page article>:first-child{margin-top:0;width:100%}#page footer,#page header{display:flex}#page footer>div,#page header>div{flex-grow:1}#page footer p,#page header p{margin:.5em 0 0}#page footer .center,#page header .center{text-align:center}#page footer .right p,#page header .right p{text-align:right}#page header{margin-top:0}#page header.has-content{border-bottom:1px solid #000}#page header.has-content+article>article>div>p:first-child,#page header.has-content+article>div>p:first-child{margin-top:1em}#page footer{margin-bottom:0}#page footer.has-content{border-top:1px solid #000}#page hr{border:none}#page hr:after{content:"* \A0   * \A0   *";display:block;text-align:center}#page .error,#page .warning{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu Cantarell,Helvetica Neue,sans-serif;font-size:80%;background:#fff5f5;color:#c92a2a;padding:.5em;border-left:4px solid #ffa8a8;position:relative;margin-bottom:1em;overflow:auto}#page .error :first-child,#page .warning :first-child{margin-top:0}#page .error :last-child,#page .warning :last-child{margin-bottom:0}#page .error a,#page .warning a{color:#c92a2a}#page .warning{background:#fff9db;color:#e67700}#page .warning a{color:#e67700}#page .fork p{display:flex;flex-direction:column;width:100%}#page .fork p a{display:block;flex-grow:1;text-align:center;padding:.5em}@media screen and (max-width:768px){#page{margin:0;width:100vw;max-width:100vw;min-height:100vh;padding:1em}}#spinner{position:absolute;bottom:0;right:0;opacity:0;transition:opacity .25s ease-in-out;pointer-events:none}#spinner.visible{display:block;opacity:1}
*{box-sizing:border-box}body{margin:0;padding:0}img{max-width:100%;height:auto}input[type=text],select{padding:.25em}pre{white-space:pre-wrap}tw-storydata{display:none}</style></head><body><form id="cb-validation" action="javascript:void(0)"><button id="cb-validation-tester" hidden></button> <button id="cb-block-enter-key" hidden></button><div id="backdrop"><div id="page" aria-live="polite"><header><div class="left"></div><div class="center"></div><div class="right"></div></header><article></article><ul class="warnings"></ul><footer><div class="left"></div><div class="center"></div><div class="right"></div></footer><div id="spinner"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDEwMCAxMDAiPgogICAgPHJlY3QgeD0iMzEiIHk9IjE0IiB3aWR0aD0iMzgiIGhlaWdodD0iNzIiIHJ4PSI0IiBmaWxsPSJ3aGl0ZSIgLz4KICAgIDxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjI4IiBmaWxsPSJ3aGl0ZSIgLz4KCTxyZWN0IHg9IjM1IiB5PSIxOCIgd2lkdGg9IjMwIiBoZWlnaHQ9IjY0IiByeD0iNCIgZmlsbD0id2hpdGUiIHN0cm9rZS13aWR0aD0iMnB4IiBzdHJva2U9ImJsYWNrIiAvPgogICAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iMjAiIHN0cm9rZT0iYmxhY2siIGZpbGw9IndoaXRlIiBzdHJva2Utd2lkdGg9IjJweCIgLz4KCTxsaW5lIHgxPSI1MCIgeTE9IjUwIiB4Mj0iNTAiIHkyPSIzNyIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLXdpZHRoPSIycHgiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+CiAgICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0KICAgICAgICAgICAgYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIgogICAgICAgICAgICBiZWdpbj0iMHMiCiAgICAgICAgICAgIGR1cj0iMjBzIgogICAgICAgICAgICB0eXBlPSJyb3RhdGUiCiAgICAgICAgICAgIGZyb209IjAgNTAgNTAiCiAgICAgICAgICAgIHRvPSIzNjAgNTAgNTAiCiAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIgogICAgICAgIC8+Cgk8L2xpbmU+Cgk8bGluZSB4MT0iNTAiIHkxPSI1MCIgeDI9IjQyIiB5Mj0iNTAiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMnB4IiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxhbmltYXRlVHJhbnNmb3JtCiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIKICAgICAgICAgICAgYmVnaW49IjBzIgogICAgICAgICAgICBkdXI9IjEyMHMiCiAgICAgICAgICAgIHR5cGU9InJvdGF0ZSIKICAgICAgICAgICAgZnJvbT0iMCA1MCA1MCIKICAgICAgICAgICAgdG89IjM2MCA1MCA1MCIKICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiCiAgICAgICAgLz4KCTwvbGluZT4KPC9zdmc+" width="40" height="40" alt=""></div></div></div></form><tw-storydata name="Scenario_DA" startnode="1" creator="Twine" creator-version="2.3.14" ifid="A897C096-E102-4098-A669-CDCAD01D07F8" zoom="0.6" format="Chapbook" format-version="1.2.1" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css"></style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-passagedata pid="1" name="Rencontre1" tags="" position="995,899" size="100,100">config.footer.left: &quot;DEBUG:{passage.name}&quot;
config.style.backdrop: &#39;gray-6&#39;
config.style.page.fork.divider.style: &#39;none&#39;
config.style.page.link.lineColor: &quot;indigo-8&quot;
config.style.page.link.active.color: &quot;indigo-8 on indigo-0&quot;

--
Quand était-ce, déjà ?

Vous deviez être en primaire.

L&#39;histoire classique d&#39;un déménagement et d&#39;un enfant qui se retrouve seul à la récréation sans trop savoir quoi faire.

&gt; [[(*Cliquer ici pour commencer.*)-&gt;Rencontre2]]


[note]
{embed image: &#39;https://images.unsplash.com/photo-1499638892001-25bdfe0bba0d?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80&#39;, alt: &#39;un joue enfant seul&#39;}

https://klembot.github.io/chapbook/guide/

</tw-passagedata><tw-passagedata pid="2" name="AccrocheConversation1" tags="" position="1597,1079" size="100,100">conversation.advise_speak_with_doctor: false
conversation.advise_official_document: false
conversation.advise_speak_with_family: false
--

C’est un soir de vacances. Le temps est doux et vous avez passé une excellente journée en compagnie de Nicolas.

Ca vous rappelle vraiment le bon temps, quand vous étiez encore deux gamins inséparables. Vous avez mangé un bon dîner ensemble, bien ri, et décidé d’allumer un feu de camp pour passer la nuit à bavarder comme le veut ce qui est désormais devenu la tradition annuelle.

Votre regard est attiré par les braises qui bondissent d&#39;entre les flammes. C&#39;est un spectacle qui vous a toujours fasciné ; vous en perdez la notion du temps.

Nicolas interrompt votre méditation :
“Tu te rappelles, la dernière fois qu’on s’est vus ?”


&gt; [[&quot;Euh ?&quot;-&gt;AccrocheConversation2]]
&gt; [[&quot;Pardon ?&quot;-&gt;AccrocheConversation2]]
</tw-passagedata><tw-passagedata pid="3" name="ConseilParlerAmis" tags="" position="2400,1023" size="100,100">conversation.advise_speak_with_doctor: true
--

&quot;Non, je n’en ai parlé à personne, tu penses qu’il faudrait ? Genre, un psy ?&quot;

Vous lui expliquez que même si vous avez conscience de votre statut d’ami privilégié, quand même, il serait peut-être pertinent d&#39;en informer d&#39;autres proches. Julien par exemple. Et puis, finalement, son médecin traitant, ça pourrait peut-être l’intéresser aussi. 

&quot;Oui, tu as raison, je vais en parler à Julien. Mon médecin, on verra.&quot;

Vous comptez mentalement vos amis en communs. 


[unless conversation.advise_speak_with_family]
&gt; [[&quot;Et parles-en à ta mère aussi.&quot;-&gt;ConseilParlerFamille]]


[continue]
&gt; [[&quot;T&#39;as fait ton testament ?&quot;-&gt;ConseilDocumentOfficiel]]
&gt; [[&quot;Comment il va Julien ?&quot;-&gt;FinDeConversation]]</tw-passagedata><tw-passagedata pid="4" name="ConseilDocumentOfficiel" tags="" position="2602,1095" size="100,100">conversation.advise_official_document: true
--

&quot;Pourquoi ? Tu veux une part, c&#39;est ça ?&quot;

Vous vous offusquez en prenant un air faussement vexé, puis vous suggérez qu&#39;un document officiel où il pourrait donner ses instructions simplifierait grandement les choses.

&quot;Mouais, c&#39;est pas faux. Je regarderai si ça existe.&quot;

Vous restez tout deux songeurs un instant.


&gt; [[Il se fait tard. -&gt;FinDeConversation]]</tw-passagedata><tw-passagedata pid="5" name="AppelTelephonique" tags="" position="2620,1463" size="100,100">conversation.personne_de_confiance: false

--

Quelques temps plus tard, Nicolas vous téléphone pour prendre des nouvelles. 

[if conversation.advise_speak_with_family | conversation.advise_speak_with_doctor]
Au cours de la conversation, vous en venez à reparler de ses souhaits en matière de fin de vie et il vous informe de ses dernières démarches.

[else]
Vous parlez de choses et d&#39;autres. La mère de Nicolas est malade et cela l&#39;inquiète beaucoup.

[if conversation.advise_speak_with_doctor]
&quot;J&#39;ai fini par suivre tes conseils : j&#39;ai informé Julien et mon médecin traitant. Julien était un peu surpris. Comme toi, quoi. Mais le médecin m&#39;a donné de bons conseils pour envisager différents cas de figures.&quot;

[if conversation.advise_speak_with_doctor &amp; conversation.advise_speak_with_family]
&quot;En revanche, avec ma famille, c&#39;était plus compliqué...&quot;

[if conversation.advise_speak_with_family]
&quot;J&#39;ai tenté d&#39;aborder le sujet avec mes parents... C&#39;était vraiment pas évident. C&#39;est plutôt tabou ce genre de choses dans ma famille. Bref, ils désapprouvent mais au moins ils ont entendu ce que j&#39;avais à dire.&quot;

[if conversation.advise_official_document | conversation.advise_speak_with_doctor]
&quot;En fait, il existe un document légal qui sert spécifiquement à indiquer ce qu&#39;on souhaiterait pour nous-même dans l&#39;éventualité où on ne pourrait pas s&#39;exprimer : ça s&#39;appelle les [[directives anticipées-&gt;Explication directives anticipées]]. Tu écris ça, tu le donnes à ton médecin traitant, et l&#39;équipe médicale qui s&#39;occupe de toi est légalement obligée de le prendre en compte.&quot;

&quot;En revanche, écrire des trucs à ce sujet dans son testament ça sert strictement à rien.&quot;

&quot;Bref, je suis content qu&#39;on en parle parce que j&#39;ai quelque chose à te demander à ce sujet.&quot;

&gt; [[Il vous demande d&#39;être sa &quot;personne de confiance&quot;.-&gt;Demande personne de confiance]]


[else]

Vous passez encore quelques temps à discuter mais bientôt le devoir vous appelle ailleurs et vous vous promettez de vous rappeler prochainement.

&gt; [[La vie continue. -&gt;Filer]]</tw-passagedata><tw-passagedata pid="6" name="Appel Julien" tags="" position="2522,1757" size="100,100">Vous en étiez à peu près à la moitié de votre vaisselle quand vous vous apercevez que votre téléphone sonne.

C&#39;est Julien. Vous décrochez enjoué bien qu&#39;un peu surpris par cet appel inopiné. Julien n&#39;a pas l&#39;habitude d&#39;appeler, c&#39;est plutôt un ami de Nicolas ; vous n&#39;avez jamais été très proches mais c&#39;est quelqu&#39;un dont vous appréciez la conversation.

Le ton grave de Julien stoppe net votre élan d&#39;enthousiasme : &quot;J&#39;ai une mauvaise nouvelle.&quot;

&gt; [[Nicolas a eu un accident.-&gt;Appel Julien II]]

[note]
Attention à présenter Julien.
Important d&#39;attendre 2-3 jours afin que le pronostic soit prononcé. </tw-passagedata><tw-passagedata pid="7" name="ConseilParlerFamille" tags="" position="2405,1151" size="100,100">conversation.advise_speak_with_family: true
--

&quot;Tu connais ma mère ? Je pense que, même si j’étais à l&#39;article de la mort, elle ne supporterait pas que l’on touche à un cheveu de son fils !&quot;

Vous faites remarquer que c&#39;est justement parce qu&#39;elle tient à lui et qu&#39;elle désapprouverait son souhait qu&#39;il serait judicieux d&#39;évoquer le sujet avec elle. Après tout, elle serait sans doute à son chevet si par malheur quoi que ce soit devait arriver.

&quot;Je voudrais pas les inquiéter pour rien. Elle va croire que j&#39;ai un cancer ou le SIDA et je vais en entendre parler pour des siècles et des siècles... Alors qu&#39;il s’est rien passé finalement lors de ce week-end.&quot;


[unless conversation.advise_speak_with_doctor]

&gt; [[&quot;D&#39;autres proches alors ?&quot;-&gt;ConseilParlerAmis]]


[continue]

&gt; [[&quot;T&#39;as fait ton testament ?&quot;-&gt;ConseilDocumentOfficiel]]
&gt; [[&quot;Elle va comment ta mère ?&quot;-&gt;FinDeConversation]]</tw-passagedata><tw-passagedata pid="8" name="Rencontre2" tags="" position="1195,900" size="100,100">Assis par terre vous regardez les autres enfants jouer en mangeant vos gâteaux préférés. Ils ont l&#39;air de bien s&#39;amuser, mais ils sont bien trop impressionnants pour que vous osiez vous approcher.

&gt; [[&quot;Mieux vaut être seul que mal accompagné.&quot; -&gt;Rencontre3_introverti]]
&gt; [[&quot;Peut-être qu&#39;ils aiment les gâteaux ?&quot; -&gt;Rencontre3_extraverti]]</tw-passagedata><tw-passagedata pid="9" name="Rencontre3_introverti" tags="" position="1345,850" size="100,100">introverti: true
--
Vous pensez à cette phrase que répète souvent votre grand-père : &quot;mieux vaut être seul que mal accompagné&quot;. Vous ne savez pas vraiment ce qu&#39;elle signifie, mais vous avez l&#39;intime conviction qu&#39;elle est appropriée pour la situation.

Cette idée vous réconforte quelque peu, et vos gâteaux aussi.

Perdu dans vos pensées, vous prenez soudainement conscience que vous n&#39;êtes pas seul et qu&#39;un enfant s&#39;est assis à vos côtés.

&gt; [[Vous faites la rencontre de Nicolas. -&gt;Rencontre4]]
</tw-passagedata><tw-passagedata pid="10" name="Rencontre3_extraverti" tags="" position="1347,968" size="100,100">introverti: false
--
Gagné par un soudain élan de détermination, vous vous levez et courrez en direction d&#39;un groupe d&#39;enfants.

Vous n&#39;avez pas le temps de proposer vos gâteaux pour acheter leur amitié qu&#39;ils vous ont déjà adopté dans leurs jeux et que bientôt, vous vous retrouvez vous aussi à courir frénétiquement de toutes parts.

&gt; [[Vous faites la rencontre de Nicolas. -&gt;Rencontre4]]
</tw-passagedata><tw-passagedata pid="11" name="Rencontre4" tags="" position="1487,905" size="100,100">Nicolas est l’ami dont vous avez toujours rêvé.

[if introverti]
Comme vous, courir partout avec les autres enfants, ça l’intimide. Alors que bavarder en partageant des gâteaux, ça vous convient à tous les deux.

[else]
Comme vous, il adore courir dans tous les sens après un ballon, et vous voilà devenu le duo de choc de la cour de récré&#39;, jamais à court d’idées pour vous amuser et inventer de nouveaux jeux qu’adorent le reste de vos camarades.

[continue]
Vous découvrez bientôt qu’il habite à deux pas de chez vous, et, dès lors, impossible de vous séparer : c’est décidé, vous serez meilleurs amis pour la vie.

&gt; [[C&#39;est le début d&#39;une belle amitié. -&gt;ContexteConversation]]</tw-passagedata><tw-passagedata pid="12" name="ContexteConversation" tags="" position="1473,1082" size="100,100">Le collège et le lycée passent, et vous commencez à prendre des chemins différents lors de vos études. Nicolas reste votre ami le plus fidèle.

[if introverti]
C&#39;est Nicolas qui vous fait découvrir l&#39;escalade ; un sport qu’il a commencé à l’université. Vous adorez ça aussi. Vous ne voyez plus Nicolas aussi souvent qu’au lycée, mais vous vous voyez de temps en temps le week-end pour grimper ensemble. Cette passion commune renforce votre amitié.

Passent encore quelques années. De mensuelles, vos sorties d’escalade deviennent annuelles.

[else]
Quand vous vous voyez, vous faites les 400 coups ensemble. C&#39;est toujours la même complicité. Sur ce point, rien n&#39;a changé depuis la primaire, mais il est déjà bien loin le temps où vous trinquiez avec du lait : à force de barathons, tout le monde vous connait et vous êtes invités partout. C&#39;est aussi que vos amis comptent sur votre réputation de joyeux lurons pour mettre l’ambiance.

Passent encore quelques années. Les tournées des bars se transforment peu à peu en soirées de mariage lorsque votre bande commence à s’installer.

[continue]
&gt; [[La vie est belle.-&gt;AccrocheConversation1]]</tw-passagedata><tw-passagedata pid="13" name="ReactionDubitative" tags="" position="1989,1219" size="100,100">conversation.reaction_approval: false
conversation.reaction_desapproval: false
conversation.reaction_dubious: true
--

Voyant votre moue, Nicolas sourit malicieusement. “Je sais que c’est un peu brutal, mais, je t’assure, j’y ai réfléchi.&quot;

{embed passage: &#39;Précisions&#39;}</tw-passagedata><tw-passagedata pid="14" name="ReactionApprobatrice" tags="" position="1995,956" size="100,100">conversation.reaction_approval: true
conversation.reaction_desapproval: false
conversation.reaction_dubious: false
--

&quot;Je grossis le trait, mais tu vois ce que je veux dire.&quot;

{embed passage: &#39;Précisions&#39;}</tw-passagedata><tw-passagedata pid="15" name="ReactionDesapprobatrice" tags="" position="1991,1087" size="100,100">conversation.reaction_approval: false
conversation.reaction_desapproval: true
conversation.reaction_dubious: false
--

&quot;Oui, enfin, dans le coma quoi : être allongé dans un lit d&#39;hôpital, avoir des gens qui font ta toilette, manger par une sonde qui passe dans ton nez, ... Enfin tu vois le tableau.&quot;

“Je sais qu’il ne nous est rien arrivé. Mais, je t’assure, ça m&#39;a fait réfléchir.&quot;


{embed passage: &#39;Précisions&#39;}</tw-passagedata><tw-passagedata pid="16" name="DonnerConseils" tags="" position="2269,1086" size="100,100">&quot;Je voulais juste te dire ce que j’en avais pensé, c’est la première fois que j’ai le sentiment de passer près de la mort comme ça. Tu me connais, ouvrir un débat philosophique, c’est pas trop mon truc !&quot;

C&#39;est vrai que la philo, ça n&#39;a jamais été son truc. Pourtant, vous sentez bien qu&#39;il s&#39;agit d&#39;une affaire importante pour Nicolas.

&gt; [[&quot;Tu en as parlé à d’autres gens que moi ?&quot;-&gt;ConseilParlerAmis]] 
&gt; [[&quot;Est-ce que ta famille est au courant ?&quot;-&gt;ConseilParlerFamille]] 
&gt; [[&quot;Je préfère qu&#39;on parle d&#39;autre chose.&quot;-&gt;FinDeConversation]]</tw-passagedata><tw-passagedata pid="17" name="FinDeConversation" tags="" position="2621,1319" size="100,100">Vous continuez à discuter quelque temps et à refaire le monde. Bientôt le sommeil vous gagne et vous décidez de rejoindre Morphée.


&gt; [[C&#39;était une belle soirée.-&gt;AppelTelephonique]]</tw-passagedata><tw-passagedata pid="18" name="Chambre" tags="" position="2789,1759" size="100,100">Empli d&#39;appréhension, vous arrivez devant la chambre de réanimation.

Vous entrez.

Nicolas est là.

Il dort sur le lit. Des tuyaux lui sortent de partout. Les machines autour de son lit donnent une atmosphère de science-fiction qui vous déconnecte encore un peu plus du réel. C&#39;est bien lui pourtant. Vous le reconnaissez. C&#39;est bien réel.

Nicolas n&#39;est pas seul. Sa famille veille sur lui et sa mère, qui vous a reconnu, s&#39;approche de vous.

&gt; [[Vous engagez la conversation.-&gt;ParlerFamille]]</tw-passagedata><tw-passagedata pid="19" name="ParlerInfirmier" tags="" position="3324,2144" size="100,100">semaines_dans_le_coma: 4
--
[if passage.visits == 1]
Ce jour-là, vous tombez sur un infirmier et décidez de lui faire part de vos interrogations. Bien qu&#39;il soit assez pressé, celui-ci accepte de répondre à vos questions.

[else]
Vous continuez à discuter avec l&#39;infirmier:

[continue]
&gt; [[&quot;Quel est l&#39;état de santé de Nicolas ?&quot;-&gt;Pronostic]]
&gt; [[&quot;Est-ce qu&#39;il souffre ?&quot;-&gt;Souffrance]]
&gt; [[&quot;Quelles sont ses chances de réveil ?&quot; -&gt;Chance de réveil]]
&gt; [[&quot;Que peut-on faire ?&quot;-&gt;ParlerInfirmier2]]


&gt; [[&quot;Nicolas n&#39;aurait pas souhaité être maintenu en vie dans ces conditions.&quot;-&gt;Souhait fin de vie]]
</tw-passagedata><tw-passagedata pid="20" name="ParlerFamille" tags="" position="2954,1763" size="100,100">Vous échangez les banalités d&#39;usage en tentant de la réconforter tout en cachant votre émotion. Sa mère vous parle de [[l&#39;accident-&gt;Explications accident]] et du [[pronostic vital-&gt;Pronostic initial]]. La situation est loin d&#39;être idéale mais Nicolas est vivant et c&#39;est le plus important.

Vous restez encore quelques temps, et bientôt vous sentez que votre présence n&#39;est plus nécessaire.

&gt; [[Laisser la famille en paix. -&gt;FinConversationFamille]] </tw-passagedata><tw-passagedata pid="21" name="Filer" tags="" position="2618,1597" size="100,100">Le temps passe. Votre devoir professionnel est décidément bien chronophage et vous avez peu de temps pour vous et vos amis. Vous réussissez toutefois à maintenir le contact avec Nicolas au gré des années, non sans efforts de part et d&#39;autres.

Vous avez la chance d&#39;être bien entouré.


&gt;[[La vie continue.-&gt;Appel Julien]] </tw-passagedata><tw-passagedata pid="22" name="1 semaine" tags="" position="3134,1879" size="100,100">Une semaine s&#39;est écoulée.

Déjà 10 jours depuis l&#39;accident.

[unless conversation.personne_de_confiance]
Vous téléphonez régulièrement à la mère de Nicolas et à Julien pour prendre des nouvelles. Nicolas a été transféré dans un autre service spécialisé dans &quot;l&#39;éveil de coma&quot;. Vous n&#39;avez pas bien compris ce que ça voulait dire, mais en tout cas il n&#39;est plus en réanimation avec tous ces tubes.

Il respire par lui-même, en revanche son état n&#39;a pas l&#39;air de s&#39;améliorer.

[continue]
Vous êtes partagé entre l&#39;espoir qu&#39;il se réveille et la certitude qu&#39;il n&#39;aimerait pas être dans cette situation. Vous repensez à vos discussions sur la fin de vie. Vous vous demandez s&#39;il souffre. S&#39;il vous entend. S&#39;il rêve.

&gt;[[Ces pensées vous angoissent.-&gt;Appel interne / 1 mois]]

</tw-passagedata><tw-passagedata pid="23" name="Explications accident" tags="" position="2910,1604" size="100,100">La mère de Nicolas vous explique qu&#39;il s&#39;est effondré alors qu&#39;il faisait son footing hebdomadaire. C&#39;est un passant qui l&#39;a trouvé par terre et qui a commencé à prodiguer les premiers secours : &quot;Heureusement qu&#39;il passait par là et qu&#39;il savait comment faire un massage cardiaque...&quot;

Personne ne sait combien de temps Nicolas est resté sans assistance.

&gt; {back link, label: &#39;↩ Retour&#39;} 

</tw-passagedata><tw-passagedata pid="24" name="Pronostic initial" tags="" position="3020,1604" size="100,100">Il est trop tôt pour savoir si Nicolas va s&#39;en sortir. L&#39;accident a eu lieu récemment. Nicolas est encore dans le coma. Les médecins lui ont fait passé des scanners. Ils disent qu&#39;il n&#39;est pas conscient mais qu&#39;il n&#39;est pas non plus dans un état de mort cérébrale. Ils surveillent son état et espèrent une évolution favorable.


&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="25" name="FinConversationFamille" tags="" position="3138,1760" size="100,100">Vous êtes bouleversé par les évènements mais bien que les nouvelles soient mauvaises vous vous attachez à rester optimiste.

&gt; [[La vie continue.-&gt;1 semaine]] </tw-passagedata><tw-passagedata pid="26" name="Explication directives anticipées" tags="" position="3497,1279" size="100,100">&quot;En France, toute personne majeure peut faire une déclaration écrite appelée *directives anticipées* pour préciser ses souhaits concernant sa fin de vie. Ce document doit guider les médecins sur les traitements à engager dans l&#39;éventualité où on ne pourrait plus exprimer ses volontés.&quot;

&quot;Concrètement, il s&#39;agit d&#39;indiquer si l&#39;on accepte -et à quelles conditions- : de limiter ou d&#39;arrêter des traitements, d&#39;être transféré en réanimation, d&#39;être mis sous respiration artificielle, de subir une intervention chirurgicale, et même d&#39;être soulagé de ses souffrances.&quot;

&quot;Les directives anticipées permettent aussi de désigner des personnes de confiances. Ce sont en somme les garants de nos volontés concernant la fin de vie : elles sont appelées par l&#39;équipe médicale pour savoir ce qu&#39;on aurait voulu pour nous-même, toujours dans l&#39;éventualité où on ne pourrait plus s&#39;exprimer.&quot;

&quot;Le plus important est sans doute de faire en sorte que les directives anticipées soient faciles d&#39;accès pour l&#39;équipe médicale. Si elles ne sont pas trouvées, c&#39;est comme si elles n&#39;existaient pas ! On peut les donner à son médecin traitant, ses proches, ses personnes de confiance, et même les déposer sur internet dans notre &#39;dossier médical partagé&#39;.&quot;

 &gt; {back link, label: &#39;↩ Retour&#39;} 
 
[note]
https://www.service-public.fr/particuliers/vosdroits/F32010</tw-passagedata><tw-passagedata pid="27" name="ParlerInfirmier2" tags="" position="3505,2230" size="100,100">L&#39;infirmier vous explique qu&#39;il n&#39;y a rien à faire. Juste continuer les soins et attendre en espérant une issue favorable.

La famille a déjà été informée des peu de chance de réveil et souhaite le maintenir en vie.


 &gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="28" name="Chance de réveil" tags="" position="3124,2340" size="100,100">&quot;Je ne peux pas vous donner de statistiques concernant la probabilité qu&#39;il se réveille. Chaque cas est unique. Les statistiques concernent les groupes, pas les individus. Personne n&#39;est à l&#39;abri d&#39;un miracle vous savez !&quot;

&quot;Tout ce que je peux vous dire, c&#39;est que son pronostic neurologique est engagé : son activité cérébrale à l&#39;IRM est faible, ce qui semble indiquer que son cerveau est durablement lésé. S&#39;il se réveille -et l&#39;équipe médicale est circonspectes à ce sujet- il y a un risque important pour qu&#39;il souffre de graves séquelles.&quot;

&quot;Vous vous en doutez, je ne peux pas vous indiquer avec certitude l&#39;ampleur de ces séquelles. Le cerveau dispose d&#39;une certaine flexibilité et peut en partie récupérer ses capacités perdues. Dans le cas de Nicolas, les zones du cerveau qui sont chez vous et moi impliquées dans la mémoire long-terme et dans la vision ont l&#39;air particulièrement endommagées. C&#39;est difficile d&#39;en dire davantage.&quot;

 &gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="29" name="Souffrance" tags="" position="3126,2483" size="100,100">&quot;Nous lui donnons des médicaments contre la douleur et nous veillons à son confort.&quot;

&quot;N&#39;hésitez pas à nous prévenir si vous pensez pour une raison ou une autre que Nicolas n&#39;est pas confortable. Nous ferons le nécessaire.&quot;

 &gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="30" name="Demande personne de confiance" tags="" position="2750,1514" size="100,100">conversation.personne_de_confiance: true
--

&quot;J&#39;aimerais que tu sois [[personne de confiance-&gt;Explication personne de confiance]]. C&#39;est une sorte de porte-parole que l&#39;équipe médicale peut appeler si je ne suis pas à même de m&#39;exprimer et dans une situation de fin de vie.&quot;


[if conversation.reaction_approval]
&quot;On en a discuté. Tu connais [[mes choix-&gt;Mes choix]] et j&#39;ai confiance en toi pour les respecter.&quot;

[if conversation.reaction_desapproval]
&quot;J&#39;ai bien conscience que ça ne te parle pas forcément ces histoires, mais je sais que tu respecterais [[mes décisions-&gt;Mes choix]] et c&#39;est ça qui m&#39;importe.&quot;

[if conversation.reaction_dubious]
&quot;J&#39;espère que maintenant qu&#39;on en a discuté tu comprends mieux ma démarche. Quoi qu&#39;il en soit, je sais que tu respecterais [[mes décisions-&gt;Mes choix]] et c&#39;est ça qui m&#39;importe.&quot;


[continue]

Vous passez encore quelques temps à discuter et vous finissez par accepter.


&gt; [[La vie continue.-&gt;Filer]]</tw-passagedata><tw-passagedata pid="31" name="Explication personne de confiance" tags="" position="3338,1418" size="100,100">&quot;Dans le cas où on ne peut plus s&#39;exprimer pour nous-même, l&#39;équipe médicale consulte en priorité la *personne de confiance* afin de prendre connaissance de nos volontés.&quot;

&quot;On désigne une personne de confiance par simple déclaration écrite. Comme pour les directives anticipées, le tout est de faire en sorte que ce document soit accessible à l&#39;équipe médicale. C&#39;est pour ça que le plus simple est sans doute de le joindre aux directives anticipées. C&#39;est évidemment une déclaration révocable à tout moment.&quot;

&quot;On peut désigner n&#39;importe qui comme personne de confiance. Par contre, la moindre des choses est de la prévenir et de bien lui expliquer nos volontés concernant la fin de vie.&quot;


&gt; {back link, label: &#39;↩ Retour&#39;} 
 
[note]
https://www.service-public.fr/particuliers/vosdroits/F32748</tw-passagedata><tw-passagedata pid="32" name="RDV équipe soignante" tags="" position="2912,2149" size="100,100">[if passage.visits == 1]
Vous arrivez à l&#39;hôpital. Le médecin vous accueille d&#39;un air grave mais courtois. Il vous demande si vous allez bien. Ça vous a toujours paru étrange venant d&#39;un médecin.

Vous prenez place à une table avec le médecin, l&#39;interne et un infirmier et commencez à discuter de Nicolas.

Ils vous expliquent qu&#39;il ont téléphoné au médecin traitant de Nicolas qui leur a transmis ses directives anticipées.

[continue]

&quot;Avant que nous ne commencions à discuter des directives anticipées de Nicolas, est-ce que vous auriez des questions ? Nous ferons notre possible pour y répondre.&quot;


&gt; [[&quot;Quel est l&#39;état de santé Nicolas ?&quot;-&gt;Pronostic]]
&gt; [[&quot;Est-ce qu&#39;il souffre ?&quot;-&gt;Souffrance]]
&gt; [[&quot;Quelle est la probabilité qu&#39;il se réveille ?&quot;-&gt;Chance de réveil]]
&gt; [[&quot;Il n&#39;y a plus rien à faire ?&quot;-&gt;Plus rien à faire]]

&gt; [[&quot;Je n&#39;ai plus de questions.&quot;-&gt;RDV équipe soignante II]]

</tw-passagedata><tw-passagedata pid="33" name="Pronostic" tags="" position="3125,2213" size="100,100">&quot;Nicolas est dans un coma prolongé suite à son arrêt cardiaque. Son cerveau n&#39;a vraisemblablement pas été alimenté en oxygène pendant un temps et ses neurones ont été endommagés. Son pronostic neurologique est engagé et l&#39;équipe médicale est réservée sur la possibilité d&#39;un réveil.&quot; 

&quot;Pour l&#39;instant son corps tient bon. Il respire par lui-même et présente encore des réflexes. Les soins et les traitements prodigués par l&#39;équipe médicale empêchent l&#39;apparition d&#39;escarres ou d&#39;autres complications.&quot;

Cette pensée vous glace.

 &gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="34" name="Souhait fin de vie" tags="" position="3508,2685" size="100,100">L&#39;infirmier tique à votre remarque.

Vous lui expliquez que Nicolas n&#39;aurait pas voulu être maintenu indéfiniment en vie, branché à des machines.

&quot;A tout hasard, vous ne sauriez pas si Nicolas a rédigé des [[directives anticipées-&gt;Explication directives anticipées]] ? Sa famille nous a dit que non. Mais bon, les gens n&#39;en parlent pas toujours à leurs proches. C&#39;est étrange mais c&#39;est comme ça. Sans directives anticipées, c&#39;est la famille qu&#39;on écoute.&quot;


[if conversation.advise_speak_with_family]
Pourtant, Nicolas vous avait bien dit qu&#39;il en avait parlé avec sa famille.

&quot;Vous savez, ce ne doit pas être facile pour eux. Vous devriez leur en parler.&quot;


[if conversation.advise_speak_with_doctor]
Vous savez que Nicolas a fait part de ses souhaits à tous ses amis proches. Vous proposez de donner les contacts de ceux qui pourraient attester de ça.

&quot;Vous savez, on a pas le temps de courir après tous ses proches. En tant que personnels soignant, c&#39;est important pour nous de savoir qu&#39;il y a une situation ambigue, mais que voulez-vous qu&#39;on y fasse ? Tout ce que je peux vous conseiller c&#39;est d&#39;en discuter avec la famille.&quot;


[note]
S&#39;il y avait des DA on ne serait pas sur cette branche du scénario.


[continue]
&gt; [[Appeller la famille.-&gt;Parler famille fin de vie]]</tw-passagedata><tw-passagedata pid="35" name="Euthanasie" tags="" position="2689,2357" size="100,100">Le médecin marque une pause.

&quot;Vous savez que l&#39;euthanasie est illégale en France ? Nous n&#39;avons pas le droit de tuer nos patients : en tant que personnel médical, nous avons fait le serment de toujours protéger la vie.&quot;

&quot;Nous pouvons soit continuer les traitements tels que nous les pratiquons actuellement, soit les arrêter, mais nous n&#39;avons pas le droit d&#39;administrer de substance léthale. Légalement, ce serait un meurtre.&quot;

 &gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="36" name="Parler famille fin de vie" tags="" position="3093,2843" size="100,100">score: 0
--

La mère de Nicolas décroche à la première sonnerie, et vous propose de passer le soir même. Enfin, si vous êtes disponible. Vous y allez ; elle habite toujours cette maison dans laquelle vous alliez goûter si souvent avec Nicolas.


[if !conversation.advise_speak_with_family &amp; !conversation.personne_de_confiance]
Vous êtes surpris d&#39;apprendre que la famille met en doute le fait que Nicolas aurait vraiment préféré mourir plutôt que d&#39;être dans sa situation actuelle. Il ne leur a vraisemblablement pas fait part de ses volontés. Par ailleurs, vous percevez qu&#39;ils ont clairement l&#39;espoir qu&#39;il se réveille, et ce malgré les réserves de l&#39;équipe médicale.

[if conversation.advise_speak_with_family &amp; conversation.personne_de_confiance]
Vous apprenez avec soulagement que la famille est bien au courant des volontés de Nicolas. Ils ont aussi pu lire les directives anticipées avec l&#39;équipe médicale. La situation est dure pour eux, ils comprennent ses volontés, mais ils ne peuvent se résoudre à &quot;l&#39;abandonner&quot;.

[if !conversation.advise_speak_with_family &amp; conversation.personne_de_confiance]
Vous apprenez avec stupeur que la famille n&#39;était pas du tout au courant des volontés de Nicolas. Ils ont été bouleversés par ses directives anticipées.

[if conversation.advise_speak_with_doctor]
Vous faites valoir que vous êtes plusieurs de ses amis à être au courant des souhaits de leur fils, et vous conseillez à la famille de les contacter. Ne serait-ce que pour échanger quelques souvenirs.

[if conversation.personne_de_confiance]
Vous l&#39;informez que l&#39;équipe médicale est prête à l&#39;arrêt des traitements et que vous avez été interrogé pour confirmer les volontés de Nicolas.

&gt; [[C&#39;est notre devoir moral de respecter la volonté de Nicolas.-&gt;Denouement euthanasie passive]]

[else]

La mère de Nicolas comprend votre démarche et apprécie que vous vous donniez du mal pour protéger la volonté de son fils. Toutefois, vous comprenez qu&#39;elle n&#39;est pas prête à le laisser partir.

&gt; [[Attendre pour en reparler plus tard.-&gt;Attendre]]
&gt; [[Laisser la famille gérer.-&gt;Denouement inaction]]</tw-passagedata><tw-passagedata pid="37" name="Attendre" tags="" position="3372,2792" size="100,100">score: score + 1
--

Vous convenez avec la mère de Nicolas d&#39;en reparler dans {cycling link for: &#39;str_waiting&#39;, choices: [&#39;1&#39;, &#39;2&#39;, &#39;4&#39;]} semaines.


&gt;[[Vous vous quittez en bon termes.-&gt;Attendre2]]

</tw-passagedata><tw-passagedata pid="38" name="Denouement inaction" tags="" position="3160,3013" size="100,100">Nicolas est parti.

Il s&#39;est éteint une nuit comme une autre, après {semaines_dans_le_coma} semaines dans le coma des suites d&#39;une infection généralisée.

Vous tenterez de toujours vous souvenir de Nicolas pour les moments heureux que vous avez passé ensemble et non pour les quelques semaines où vous l&#39;avez vu dépérir dans son lit d&#39;hôpital.

Vous auriez aimé lui parler avant qu&#39;il ne parte. La vie en a décidé autrement.

Nicolas ne voulait pas mourir. Mais vous savez qu&#39;il n&#39;aurait pas souhaité continuer à survivre ainsi. Cette pensée vous réconforte quelque part, mais vous ne savez que trop bien à quelle point elle est étrangère à sa propre famille. A eux, il ne reste qu&#39;un cruel sentiment d&#39;abandon.

Pourtant, si vous aviez osé aider Nicolas dans sa réflexion concernant la fin de vie, il aurait peut-être écrit ses directives anticipées et les choses se seraient sans doute passées autrement.

 
 
[[**FIN**-&gt;FIN]]
</tw-passagedata><tw-passagedata pid="39" name="FIN" tags="" position="3087,3167.3333333333335" size="100,100">&gt; **FIN**

Nicolas n&#39;existe pas, mais vous, oui !

Alors ne tardez pas à vous renseigner sur les directives anticipées, la loi Claeys-Leonetti, et surtout : parlez à vos proches de ce que vous souhaiteriez qu&#39;ils fassent si par malheur vous n&#39;étiez pas en mesure de vous exprimer.

C&#39;est important : prenez le temps de le faire.</tw-passagedata><tw-passagedata pid="40" name="Denouement euthanasie passive" tags="" position="3011,3011" size="100,100">Nicolas est parti.

Il s&#39;est éteint dans la nuit, quelques semaines après son accident.

Afin de se conformer à ses souhaits, l&#39;équipe médicale a arrêté tous les traitements, y-compris l&#39;alimentation et l&#39;hydratation. Nicolas est décédé six jours plus tard.

Vous auriez aimé lui parler avant qu&#39;il ne parte. La vie en a décidé autrement.

Nicolas ne voulait pas mourir. Mais vous savez qu&#39;il n&#39;aurait pas souhaité continuer à survivre ainsi. Grâce aux directives anticipées et à votre aide, il a été facile pour le personnel médical de respecter les volontés de Nicolas.
 
 
[[**FIN**-&gt;FIN]]</tw-passagedata><tw-passagedata pid="41" name="Dossier médical" tags="" position="2447,2787" size="100,100">&quot;Je regrette mais nous ne pouvons pas vous transmettre le dossier médical : ce serait en infraction avec le secret médical.&quot;

&quot;Nicolas aurait pu vous autoriser à accéder à son dossier médical en signant un document vous déléguant ces droits. Cela peut aussi s&#39;écrire dans les directives anticipées. Dans le cas présent, nous n&#39;avons pas de tel document.&quot;


&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="42" name="Attendre2" tags="" position="3366,2929" size="100,100">waiting (str_waiting===&#39;1&#39;) : 1
waiting (str_waiting===&#39;2&#39;) : 2
waiting (str_waiting===&#39;4&#39;) : 4

semaines_dans_le_coma: semaines_dans_le_coma + waiting
--


Cela fait maintenant {semaines_dans_le_coma} semaines que Nicolas est dans le coma.


[if score&lt;=1]
L&#39;état de Nicolas ne s&#39;est pas amélioré. Il a encore maigri et les traitements sont de plus en plus lourds. Suite à une infection, il est maintenant sous dialyse.

La famille ne souhaite pas entamer la procédure d&#39;arrêt des traitements. Ce sont toujours les mêmes arguments. Fondamentalement, ils ne peuvent pas croire que leur proche aurait vraiment souhaité mourir : ils auraient le sentiment de le trahir en arrêtant les traitements. Ils s&#39;accrochent tant bien que mal à la possibilité d&#39;un rétablissement miracle.

Vous constatez qu&#39;il y a beaucoup de souffrance.

&gt; [[Vous décidez d&#39;attendre encore avant d&#39;en reparler.-&gt;Attendre]]
&gt; [[Laisser la famille gérer.-&gt;Denouement inaction]]


[if score&gt;=2]
L&#39;état de Nicolas s&#39;est encore dégradé. Les médecins ont décidé de limiter les traitements... Cela veut dire qu&#39;ils ne traiteront pas la prochaine infection, ou qu&#39;il ne procéderont pas à une réanimation si le cœur de Nicolas venait à s&#39;arrêter de nouveau... Ils disent qu&#39;ils n&#39;ont pas le droit de faire de &quot;l&#39;obstination déraisonnable&quot;. C&#39;est le nouveau terme pour &quot;acharnement thérapeutique&quot;.

Evidemment, la famille n&#39;est pas d&#39;accord. Ils oscillent entre colère et désemparement. Ils sont même convaincus que Nicolas est maltraité et que l&#39;équipe médicale agit uniquement pour libérer son lit.

Vous tentez en vain d&#39;aborder les volontés de Nicolas concernant sa fin de vie, mais vous comprenez vite que le temps n&#39;est pas à l&#39;apaisement. 

Vous plaignez la famille, l&#39;équipe médicale et bien sûr votre ami. Il n&#39;aurait certainement pas souhaité que ça se passe comme ça.

&gt; [[Vous décidez d&#39;attendre encore avant d&#39;en reparler.-&gt;Denouement inaction]]
&gt; [[Laisser la famille gérer.-&gt;Denouement inaction]]
</tw-passagedata><tw-passagedata pid="43" name="DEBUG_ParlerFamilleFinDeVie" tags="" position="2401,2969" size="200,200">config.footer.left: &quot;DEBUG:{passage.name}&quot;
config.style.backdrop: &#39;gray-6&#39;
config.style.page.fork.divider.style: &#39;none&#39;
config.style.page.link.lineColor: &quot;indigo-8&quot;
config.style.page.link.active.color: &quot;indigo-8 on indigo-0&quot;

conversation.advise_speak_with_doctor: false
conversation.advise_speak_with_family: false
conversation.advise_official_document: false

conversation.personne_de_confiance: false
semaines_dans_le_coma: 1
--

[[Parler famille fin de vie]]</tw-passagedata><tw-passagedata pid="44" name="Confirmer DA" tags="" position="2831,2430" size="100,100">Vous confirmez que les DA sont fidèles à la volonté de Nicolas telle que vous en avez discuté avec lui.

Le médecin en prend note et continue à parler.

&quot;La loi nous exhorte à protéger la volonté des patients et notamment leur droit à refuser les traitements. C&#39;est en ce sens que les volontés des patients sont collectées dans les directives anticipées afin que l&#39;on sache ce qu&#39;aurait voulu le patient pour lui-même dans le cas où il ne serait pas en mesure de s&#39;exprimer.&quot;

&quot;Mais je dois dire que c&#39;est très important pour nous de discuter avec la famille et les éventuelles personnes de confiance afin de comprendre ce que voulait vraiment le patient et de nous assurer qu&#39;il n&#39;a pas écrit ses directives dans un mouvement d&#39;humeur, ou qu&#39;il n&#39;a pas changé d&#39;avis entre temps.&quot;

&gt;[[L&#39;équipe médicale vous remercie de les rassurer sur ces points.-&gt;Arrêt des traitements]]</tw-passagedata><tw-passagedata pid="45" name="Décision arrêt des traitements" tags="" position="2830,2690" size="100,100">&quot;Très bien, nous en informerons le reste de l&#39;équipe médicale. [[C&#39;est elle qui doit statuer sur l&#39;arrêt ou non des traitements.-&gt;Decision arret des traitements II]]&quot;

&quot;Compte tenu de son [[dossier médical-&gt;Dossier médical]], nous pourrions envisager une telle procédure pour Nicolas.&quot;

&quot;Toutefois, notre devoir est aussi de prendre soin de sa famille et de ne pas créer chez eux un traumatisme supplémentaire. Nous avons déjà discuté avec la mère de Nicolas des directives anticipées de son fils. Si vous la connaissez, je vous encourage à prendre contact avec elle. Ca l&#39;aiderait à comprendre et accepter la décision de Nicolas.&quot;

&quot;Merci encore d&#39;être venu aujourd&#39;hui.&quot;

L&#39;entretien se termine et vous quittez l&#39;hôpital.

&gt; [[Appeler la mère de Nicolas.-&gt;Parler famille fin de vie]]</tw-passagedata><tw-passagedata pid="46" name="Plus rien à faire" tags="" position="2696,2220" size="100,100">Le médecin s&#39;arrête un instant et précise sa pensée.

&quot;Je me suis peut-être mal fait comprendre. Ne croyez pas que nous ne faisons rien pour votre ami. C&#39;est tout le contraire. Notre équipe est 100% dédiée à ses patients et nous avons à cœur de leur offrir les meilleurs traitements en respectant leurs volontés.&quot;

&quot;Nicolas est aujourd&#39;hui dans un état stable. Mais nos meilleurs traitements ont peu de chance de le faire revenir en pleine possession de ses moyens.&quot;

&quot;Si nous vous avons demandé de venir aujourd&#39;hui c&#39;est pour discuter de la volonté de Nicolas. De ce qu&#39;il voudrait qu&#39;on fasse s&#39;il était en mesure de s&#39;exprimer.&quot;


&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="47" name="Decision arret des traitements II" tags="" position="2450,2664" size="100,100">Votre œil intrigué n&#39;a pas échappé à celui, bien exercé, du médecin.

&quot;Les directives anticipées ne sont pas contraignantes. La décision d&#39;arrêter ou non les traitements revient exclusivement à l&#39;équipe médicale. C&#39;est notre responsabilité professionnelle. Les directives anticipées -et les personnes de confiances- ne sont là que pour nous aider à prendre notre décision pour le bien du patient.&quot;


&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="48" name="Arrêt des traitements" tags="" position="2830,2559" size="100,100">&quot;Dans ce contexte, la loi nous autorise à engager une procédure d&#39;arrêt des traitements, de tous les traitements, y compris de l&#39;alimentation et de l&#39;hydratation jusqu&#39;au décès.&quot;

&quot;Bien entendu, nous ferions en sorte qu&#39;il ne souffre pas en lui administrant des antalgiques et en continuant les soins de conforts.&quot;

En disant cela, le médecin pose son regard au fond du votre. Il attend visiblement votre réaction.

&gt; [[&quot;Combien de temps cela va prendre ?&quot;-&gt;Temps arrêt traitements]]
&gt; [[&quot;Est-ce qu&#39;il aura faim ? soif ?&quot;-&gt;Est-ce qu&#39;il aura faim ? soif ?]]
&gt; [[&quot;Suggérer de l&#39;euthanasier.&quot;-&gt;Euthanasie]]

 
&gt; [[&quot;C&#39;est ce qu&#39;aurait voulu Nicolas.&quot;-&gt;Décision arrêt des traitements]]</tw-passagedata><tw-passagedata pid="49" name="RappelEvenement" tags="" position="1858,1081" size="100,100">Effectivement, vous vous en rappelez, ça n’était pas passé loin. Enfin, vous, vous vous rappelez surtout que le week-end était sympa, mais visiblement Nicolas a été chamboulé par cette histoire.

“J’y ai pas mal réfléchi. Si jamais il m’arrivait un truc comme ça, et que j’étais coincé à l’hôpital, j’aimerais pas me retrouver comme un légume : j&#39;aimerais qu&#39;on me débranche et qu&#39;on me laisse mourir en paix.”

Ah oui, ça l’a quand même plus secoué que ce que vous imaginiez.

&gt; [[Approuver.-&gt;ReactionApprobatrice]]
&gt; [[Désapprouver.-&gt;ReactionDesapprobatrice]]
&gt; [[Faire une moue dubitative.-&gt;ReactionDubitative]]</tw-passagedata><tw-passagedata pid="50" name="Précisions" tags="" position="2111,1086" size="100,100">&quot;En fait, ça m’a fait prendre conscience de ce qui me plaisait et est important pour moi dans la vie : passer du temps avec les gens qui comptent, sortir, profiter d’un coucher de soleil après une journée de randonnée…&quot;

Nicolas marque une pause.

&quot;En fait, si je suis juste un corps branché sur des machines, je n’aurai plus l’impression que c’est _moi_ ce corps, juste le corps que j’ai habité un temps. Si on ne peut pas échanger avec les gens qui nous sont chers, est-ce que c&#39;est encore vivre ?&quot;

Son regard se tourne vers vous.

&gt;[[&quot;Ce n’est pas forcément ma conception de l&#39;identité, mais pourquoi pas ?&quot;-&gt;DonnerConseils]]
&gt;[[&quot;Tu vas te mettre à me parler de ton âme et de la dualité corps/esprit ?&quot;-&gt;DonnerConseils]]
&gt;[[Vous replongez votre regard dans les flammes, en pensant à ses paroles.-&gt;DonnerConseils]]
</tw-passagedata><tw-passagedata pid="51" name="AccrocheConversation2" tags="" position="1731,1079" size="100,100">Au terme d&#39;un bref effort de concentration vous délaissez le feu pour tenter d&#39;extraire quelques souvenirs de votre mémoire défaillante.

[if introverti]
Vous vous souvenez d&#39;une sortie en montagne... 

C&#39;était _quelle_ montagne déjà ?

Vous en êtes à peu près là de vos réflexions quand Nicolas reprend : “Moi, je n’arrête pas d’y penser. Tu te rappelles de cette pierre qui était passée à deux pas de moi ? Je me dis que j’ai failli y passer, ou que si je me l’étais prise sur la tête -même avec mon casque- ça aurait été franchement désagréable.” 

[else]
Vous vous souvenez d&#39;un mariage...

C&#39;était le mariage de _qui_ déjà ?

Vous en êtes à peu près là de vos réflexions quand Nicolas reprend : “Moi, je n’arrête pas d’y penser. Tu te rappelles de cette voiture qui avait grillé un stop devant nous quand on rentrait ? Je me dis qu’on a failli y passer, ou qu’en tout cas on aurait pu avoir un accident grave ce jour-là.” 

[continue]
Nicolas a l&#39;air sérieux.

&gt;[[Vous vous concentrez davantage.-&gt;RappelEvenement]]</tw-passagedata><tw-passagedata pid="52" name="DEBUG_AppelTelephonique" tags="" position="2252,1473" size="200,200">config.footer.left: &quot;DEBUG:{passage.name}&quot;
config.style.backdrop: &#39;gray-6&#39;
config.style.page.fork.divider.style: &#39;none&#39;
config.style.page.link.lineColor: &quot;indigo-8&quot;
config.style.page.link.active.color: &quot;indigo-8 on indigo-0&quot;

conversation.reaction_approval: false
conversation.reaction_desapproval: true
conversation.reaction_dubious: false

conversation.advise_speak_with_doctor: true
conversation.advise_speak_with_family: true
conversation.advise_official_document: false
--


&gt;[[DEBUG-&gt;AppelTelephonique]]</tw-passagedata><tw-passagedata pid="53" name="Mes choix" tags="" position="2909,1487" size="100,100">Vous demandez à Nicolas de vous rappeler ses choix dans l&#39;éventualité où il ne pourrait plus s&#39;exprimer.

&quot;Bah, tu sais bien : tu débranches tout !&quot;

&quot;Plus sérieusement, je ne veux pas être maintenu en vie par des machines. Enfin, pas trop longtemps quoi : je ne suis pas fondamentalement anti-réanimation, c&#39;est juste que je refuse que mon existence se résume à elles. Je vais pas te donner un nombre d&#39;heures à partir desquelles tu peux tout débrancher - ce serait ridicule - mais tu vois ce que je veux dire ?&quot;

&quot;En fait, ce qui me fait le plus peur c&#39;est de me réveiller et d&#39;être enfermé dans mon propre corps. Comme dans *Le scaphandre et le papillon*, je sais pas si tu as vu ce film ? Ou pire : de ne pas récupérer mes capacités cognitives... Quand tu restes trop longtemps dans un état qui nécessite d&#39;être branché à des machines tu as souvent des séquelles.&quot;


&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="54" name="Appel interne / 1 mois" tags="" position="3136,2008" size="100,100">[if conversation.personne_de_confiance]
Votre téléphone sonne. C&#39;est un numéro inconnu.

Un interne souhaite prendre rendez-vous pour discuter du cas de Nicolas avec l&#39;équipe paramédicale. Il vous explique qu&#39;en votre qualité de personne de confiance c&#39;est la procédure normale et qu&#39;il n&#39;y a pas lieu de s&#39;inquiéter.

&gt; [[Vous prenez rendez-vous pour la semaine suivante.-&gt;RDV équipe soignante]]


[else]
Cela fait maintenant un mois que Nicolas est dans le coma.

Son état est stable mais il a beaucoup maigri. Chaque jour des aides-soignants viennent lui faire sa toilette et lui mouiller les lèvres pour éviter qu&#39;elles ne se dessèchent.

On lui a fait une gastrostomie. C&#39;est une sonde qui le nourrit directement dans l&#39;estomac en passant par un trou ouvert dans son ventre. Les infirmiers disent que celle qui passait par son nez l&#39;irritait et risquait de causer une infection.

Il y a un kiné qui passe aussi. Il fait de la rééducation. Pour bouger ses articulations, masser ses muscles et éviter qu&#39;il ne fasse des escarres.

Votre ami vous semble bien loin de vous. Il vous manque.


&gt; [[Vous allez à l&#39;hôpital.-&gt;ParlerInfirmier]]
</tw-passagedata><tw-passagedata pid="55" name="Appel Julien II" tags="" position="2657,1760" size="100,100">Julien vous transmet le peu d&#39;informations qu&#39;il a en sa possession. Il a reçu un appel d&#39;une cousine de Nicolas que vous êtes censé connaitre mais dont vous n&#39;avez aucun souvenir.

Nicolas se trouve dans un état critique à l&#39;hôpital. Il y a été emmené par les pompiers qui l&#39;ont trouvé inanimé sur la voirie. Les circonstances de l&#39;accident sont encore floues mais Nicolas est en service de réanimation depuis deux jours maintenant. Toute la famille est en alerte.

Vous remerciez Julien de vous avoir prévenu et prenez vos dispositions pour aller à l&#39;hôpital dès le lendemain.

&gt; [[Aller à l&#39;hôpital.-&gt;Chambre]]
</tw-passagedata><tw-passagedata pid="56" name="RDV équipe soignante II" tags="" position="2832,2306" size="100,100">&quot;Très bien, commençons.&quot;

&quot;Les directives anticipées sont claires sur un point : Nicolas ne souhaitait pas être maintenu en vie dans le coma s&#39;il pouvait en sortir avec des séquelles. Cela fait maintenant deux semaines que son état est stable et nous ne voyons pas de dynamique d&#39;amélioration.&quot;

&quot;En votre qualité de personne de confiance, nous souhaiterions que vous confirmiez que les directives anticipées correspondent bien aux souhaits de Nicolas tels que vous en avez discuté avec lui.&quot;

&gt; [[&quot;Nicolas n&#39;aurait pas souhaité être maintenu en vie dans ces conditions.&quot;-&gt;Confirmer DA]]
&gt; [[Suggérer de l&#39;euthanasier.-&gt;Euthanasie]]

&gt; [[↩ &quot;J&#39;ai encore des questions.&quot;-&gt;RDV équipe soignante]]</tw-passagedata><tw-passagedata pid="57" name="DEBUG RDV équipe soignante" tags="" position="2397,2159" size="200,200">config.footer.left: &quot;DEBUG:{passage.name}&quot;
config.style.backdrop: &#39;gray-6&#39;
config.style.page.fork.divider.style: &#39;none&#39;
config.style.page.link.lineColor: &quot;indigo-8&quot;
config.style.page.link.active.color: &quot;indigo-8 on indigo-0&quot;

conversation.reaction_approval: false
conversation.reaction_desapproval: true
conversation.reaction_dubious: false

conversation.advise_speak_with_doctor: true
conversation.advise_speak_with_family: true
conversation.advise_official_document: true

conversation.personne_de_confiance: true
--


&gt;[[DEBUG-&gt;RDV équipe soignante]]</tw-passagedata><tw-passagedata pid="58" name="Temps arrêt traitements" tags="" position="2548,2559" size="100,100">&quot;Je ne peux pas le prévoir, c&#39;est propre à chaque personne.&quot;

&quot;Cela dépend de l&#39;état de santé du patient. Hormis son pronostique neurologique, Nicolas est encore en relativement en bonne santé. Son corps devrait lâcher au bout de quelques jours.&quot;

&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata><tw-passagedata pid="59" name="Est-ce qu&#39;il aura faim ? soif ?" tags="" position="2540,2434" size="100,100">&quot;Non, non. Premièrement, rien ne nous indique qu&#39;il soit conscient. Il n&#39;aura pas plus faim ou soif que vous ou moi quand nous dormons.&quot;

&quot;Ensuite, nous continuerons à pratiquer les soins pour hydrater sa bouche et empêcher qu&#39;elle ne se dessèche. Sans déshydratation des muqueuses, il n&#39;y a pas de sensation de soif.&quot;

&gt; {back link, label: &#39;↩ Retour&#39;} </tw-passagedata></tw-storydata><script>!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=28)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=t.set=t.defaults=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.init=function(){var e=(0,u.ifid)(),t=(0,u.name)();if(void 0===t)throw new Error("Cannot set up state: the story has no name");d="chapbook-state-"+t+"-"+e},t.reset=m,t.sameObject=function(e,t){for(var n=e.split("."),r=t.split("."),o=0;o<n.length&&o<r.length;o++)if(n[o]!==r[o])return!1;return!0},t.setDefault=function(e,t){var n=y(e);f('Defaulting "'+e+'" to '+JSON.stringify(t)),(0,i.default)(h,e,t),v(window,e),null==n&&s.default.emit("state-change",{name:e,value:t,previous:n})},t.setLookup=function(e,t){var n=y(e);f("Adding lookup variable "+e),(0,i.default)(g,e,t),function(e,t){if(!e[t]){for(var n=t.split("."),r=n[n.length-1],o=0;o<n.length-1;o++)e[n[o]]=e[n[o]]||{},e=e[n[o]];Object.defineProperty(e,r,{get:function(){return y(t)},set:function(){throw new Error("Chapbook lookup variables may only be read.")},configurable:!0})}}(window,e),null==n&&s.default.emit("state-change",{name:e,value:y(e),previous:n})},t.saveToObject=k,t.restoreFromObject=w,t.canSaveToStorage=x,t.saveToStorage=_,t.canRestoreFromStorage=function(){return x()&&null!==window.localStorage.getItem(d)},t.restoreFromStorage=function(){f("Restoring variables from local storage"),w(JSON.parse(window.localStorage.getItem(d))),f("Restore complete")},t.purgeFromStorage=function(e){e||f("Purging variables from local storage");w(JSON.parse(window.localStorage.getItem(d))),e||f("Purge complete")},t.varNames=function(e){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object.keys(e).reduce(function(o,i){if("object"===r(e[i])&&e[i]&&!Array.isArray(e[i]))t(e[i],n?n+"."+i:i,o);else{var a=n?n+"."+i:i;-1===o.indexOf(a)&&o.push(a)}return o},o)}if(e)return t(h,null,t(p,null)).sort();return t(p).sort()};var o=c(n(34)),i=c(n(35)),a=c(n(37)),s=c(n(1)),l=c(n(4)),u=n(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=(0,l.default)("state").log,d=void 0,p={},h={},g={};function v(e,t){if(!e[t]){Object.defineProperty(e,t,{get:function(){return y(t)},set:function(e){b(t,e)},configurable:!0});var n=t.split(".");n.length>1&&(n.pop(),v(e,n.join(".")))}}function m(){!function e(t,n){Object.keys(t).forEach(function(o){var i,l,u=""===n?o:n+"."+o;if("object"!==r(t[o])||Array.isArray(t[o])){var c=t[o];delete t[o],i=window,l=n,(0,a.default)(i,l),s.default.emit("state-change",{name:u,value:y(u),previous:c})}else e(t[o],u)})}(p,""),s.default.emit("state-reset"),y("config.state.autosave")&&_()}function b(e,t){var n=y(e);(0,i.default)(p,e,t),v(window,e),t!==n&&s.default.emit("state-change",{name:e,previous:n,value:t}),y("config.state.autosave")&&_()}function y(e){var t=(0,o.default)(g,e);if("function"==typeof t)return t(y,b);var n=(0,o.default)(p,e);return null==n?(0,o.default)(h,e):n}function k(){return Object.assign({},p)}function w(e){m(),Object.keys(e).forEach(function(t){return b(t,e[t])})}function x(){try{return window.localStorage.setItem("chapbook-test","a"),window.localStorage.removeItem("chapbook-test"),!0}catch(e){return!1}}function _(){f("Saving to local storage: "+JSON.stringify(k())),window.localStorage.setItem(d,JSON.stringify(k())),f("Save complete")}t.defaults={"config.state.autosave":!0},t.set=b,t.get=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(30),i=(r=o)&&r.__esModule?r:{default:r};t.default=(0,i.default)()},function(e,t,n){"use strict";n.r(t),n.d(t,"h",function(){return s}),n.d(t,"createElement",function(){return s}),n.d(t,"cloneElement",function(){return f}),n.d(t,"createRef",function(){return I}),n.d(t,"Component",function(){return N}),n.d(t,"render",function(){return D}),n.d(t,"rerender",function(){return g}),n.d(t,"options",function(){return o});var r=function(){},o={},i=[],a=[];function s(e,t){var n,s,l,u,c=a;for(u=arguments.length;u-- >2;)i.push(arguments[u]);for(t&&null!=t.children&&(i.length||i.push(t.children),delete t.children);i.length;)if((s=i.pop())&&void 0!==s.pop)for(u=s.length;u--;)i.push(s[u]);else"boolean"==typeof s&&(s=null),(l="function"!=typeof e)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(l=!1)),l&&n?c[c.length-1]+=s:c===a?c=[s]:c.push(s),n=l;var f=new r;return f.nodeName=e,f.children=c,f.attributes=null==t?void 0:t,f.key=null==t?void 0:t.key,void 0!==o.vnode&&o.vnode(f),f}function l(e,t){for(var n in t)e[n]=t[n];return e}function u(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function f(e,t){return s(e.nodeName,l(l({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var d=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,p=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==p.push(e)&&(o.debounceRendering||c)(g)}function g(){for(var e;e=p.pop();)e._dirty&&T(e)}function v(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function m(e){var t=l({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function b(e){var t=e.parentNode;t&&t.removeChild(e)}function y(e,t,n,r,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)u(n,null),u(r,e);else if("class"!==t||o)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"==typeof r[i]&&!1===d.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,k,a):e.removeEventListener(t,k,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!o&&t in e){try{e[t]=null==r?"":r}catch(e){}null!=r&&!1!==r||"spellcheck"==t||e.removeAttribute(t)}else{var s=o&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function k(e){return this._listeners[e.type](o.event&&o.event(e)||e)}var w=[],x=0,_=!1,S=!1;function j(){for(var e;e=w.shift();)o.afterMount&&o.afterMount(e),e.componentDidMount&&e.componentDidMount()}function O(e,t,n,r,o,i){x++||(_=null!=o&&void 0!==o.ownerSVGElement,S=null!=e&&!("__preactattr_"in e));var a=C(e,t,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--x||(S=!1,i||j()),a}function C(e,t,n,r,o){var i=e,a=_;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),M(e,!0))),i.__preactattr_=!0,i;var s,l,u=t.nodeName;if("function"==typeof u)return function(e,t,n,r){var o=e&&e._component,i=o,a=e,s=o&&e._componentConstructor===t.nodeName,l=s,u=m(t);for(;o&&!l&&(o=o._parentComponent);)l=o.constructor===t.nodeName;o&&l&&(!r||o._component)?($(o,u,3,n,r),e=o.base):(i&&!s&&(z(i),e=a=null),o=P(t.nodeName,u,n),e&&!o.nextBase&&(o.nextBase=e,a=null),$(o,u,1,n,r),e=o.base,a&&e!==a&&(a._component=null,M(a,!1)));return e}(e,t,n,r);if(_="svg"===u||"foreignObject"!==u&&_,u=String(u),(!e||!v(e,u))&&(s=u,(l=_?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,i=l,e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),M(e,!0)}var c=i.firstChild,f=i.__preactattr_,d=t.children;if(null==f){f=i.__preactattr_={};for(var p=i.attributes,h=p.length;h--;)f[p[h].name]=p[h].value}return!S&&d&&1===d.length&&"string"==typeof d[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=d[0]&&(c.nodeValue=d[0]):(d&&d.length||null!=c)&&function(e,t,n,r,o){var i,a,s,l,u,c=e.childNodes,f=[],d={},p=0,h=0,g=c.length,m=0,y=t?t.length:0;if(0!==g)for(var k=0;k<g;k++){var w=c[k],x=w.__preactattr_,_=y&&x?w._component?w._component.__key:x.key:null;null!=_?(p++,d[_]=w):(x||(void 0!==w.splitText?!o||w.nodeValue.trim():o))&&(f[m++]=w)}if(0!==y)for(var k=0;k<y;k++){l=t[k],u=null;var _=l.key;if(null!=_)p&&void 0!==d[_]&&(u=d[_],d[_]=void 0,p--);else if(h<m)for(i=h;i<m;i++)if(void 0!==f[i]&&(S=a=f[i],O=o,"string"==typeof(j=l)||"number"==typeof j?void 0!==S.splitText:"string"==typeof j.nodeName?!S._componentConstructor&&v(S,j.nodeName):O||S._componentConstructor===j.nodeName)){u=a,f[i]=void 0,i===m-1&&m--,i===h&&h++;break}u=C(u,l,n,r),s=c[k],u&&u!==e&&u!==s&&(null==s?e.appendChild(u):u===s.nextSibling?b(s):e.insertBefore(u,s))}var S,j,O;if(p)for(var k in d)void 0!==d[k]&&M(d[k],!1);for(;h<=m;)void 0!==(u=f[m--])&&M(u,!1)}(i,d,n,r,S||null!=f.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||y(e,r,n[r],n[r]=void 0,_);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||y(e,r,n[r],n[r]=t[r],_)}(i,t.attributes,f),_=a,i}function M(e,t){var n=e._component;n?z(n):(null!=e.__preactattr_&&u(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||b(e),A(e))}function A(e){for(e=e.lastChild;e;){var t=e.previousSibling;M(e,!0),e=t}}var E=[];function P(e,t,n){var r,o=E.length;for(e.prototype&&e.prototype.render?(r=new e(t,n),N.call(r,t,n)):((r=new N(t,n)).constructor=e,r.render=L);o--;)if(E[o].constructor===e)return r.nextBase=E[o].nextBase,E.splice(o,1),r;return r}function L(e,t,n){return this.constructor(e,n)}function $(e,t,n,r,i){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r)),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===o.syncComponentUpdates&&e.base?h(e):T(e,1,i)),u(e.__ref,e))}function T(e,t,n,r){if(!e._disable){var i,a,s,u=e.props,c=e.state,f=e.context,d=e.prevProps||u,p=e.prevState||c,h=e.prevContext||f,g=e.base,v=e.nextBase,b=g||v,y=e._component,k=!1,_=h;if(e.constructor.getDerivedStateFromProps&&(c=l(l({},c),e.constructor.getDerivedStateFromProps(u,c)),e.state=c),g&&(e.props=d,e.state=p,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,c,f)?k=!0:e.componentWillUpdate&&e.componentWillUpdate(u,c,f),e.props=u,e.state=c,e.context=f),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!k){i=e.render(u,c,f),e.getChildContext&&(f=l(l({},f),e.getChildContext())),g&&e.getSnapshotBeforeUpdate&&(_=e.getSnapshotBeforeUpdate(d,p));var S,C,A=i&&i.nodeName;if("function"==typeof A){var E=m(i);(a=y)&&a.constructor===A&&E.key==a.__key?$(a,E,1,f,!1):(S=a,e._component=a=P(A,E,f),a.nextBase=a.nextBase||v,a._parentComponent=e,$(a,E,0,f,!1),T(a,1,n,!0)),C=a.base}else s=b,(S=y)&&(s=e._component=null),(b||1===t)&&(s&&(s._component=null),C=O(s,i,f,n||!g,b&&b.parentNode,!0));if(b&&C!==b&&a!==y){var L=b.parentNode;L&&C!==L&&(L.replaceChild(C,b),S||(b._component=null,M(b,!1)))}if(S&&z(S),e.base=C,C&&!r){for(var N=e,D=e;D=D._parentComponent;)(N=D).base=C;C._component=N,C._componentConstructor=N.constructor}}for(!g||n?w.push(e):k||(e.componentDidUpdate&&e.componentDidUpdate(d,p,_),o.afterUpdate&&o.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);x||r||j()}}function z(e){o.beforeUnmount&&o.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?z(n):t&&(null!=t.__preactattr_&&u(t.__preactattr_.ref,null),e.nextBase=t,b(t),E.push(e),A(t)),u(e.__ref,null)}function N(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function D(e,t,n){return O(n,e,{},!1,t,!1)}function I(){return{}}l(N.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=l(l({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),h(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),T(this,2)},render:function(){}});var R={h:s,createElement:s,cloneElement:f,createRef:I,Component:N,render:D,rerender:g,options:o};t.default=R},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warn=t.log=t.defaults=void 0,t.default=function(e){return{log:function(t){l(e,t)},warn:function(t){u(e,t)}}};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(0);t.defaults={"config.logger.show.parse":!1,"config.logger.show.render":!1,"config.logger.show.sound":!1,"config.logger.show.state":!1,"config.logger.show.story":!1,"config.logger.show.style":!1};function s(e){return e+": "}function l(e,t){(0,a.get)("config.logger.show."+e)&&console.log(s(e)+t),i.default.emit("log",{source:e,message:t})}function u(e,t){console.warn(s(e)+t),i.default.emit("log-warning",{source:e,message:t})}t.log=l,t.warn=u,window.logger={log:l,warn:u}},function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=document.createElement(e);return Object.keys(t).forEach(function(e){void 0!==t[e]&&r.setAttribute(e,t[e])}),n.forEach(function(e){"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e)}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.domify=r,t.default=function(){return r.apply(void 0,arguments).outerHTML}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.passages=void 0,t.loadFromData=function(e){["name","creator","ifid","options"].forEach(function(t){return u[t]=e.getAttribute(t)}),u.startNode=parseInt(e.getAttribute("startnode")),u.creatorVersion=e.getAttribute("creator-version");var t=function(e){return e.map(function(e){return e.textContent})};u.customScripts=t((0,a.selectAll)(e,'[type="text/twine-javascript"]')),u.customStyles=t((0,a.selectAll)(e,'[type="text/twine-css"]')),c=(0,a.selectAll)(e,"tw-passagedata").map(function(e){var t={id:parseInt(e.getAttribute("pid")),name:e.getAttribute("name"),source:e.textContent},n=e.getAttribute("tags");return t.tags=n?n.split(" "):[],t})},t.init=function(){(0,s.setDefault)("trail",[d().name]),(0,s.setDefault)("config.testing","string"==typeof u.options&&-1!==u.options.indexOf("debug")||!1),document.title=u.name},t.runCustomScripts=function(){l.log("Running custom scripts ("+u.customScripts.length+")"),u.customScripts.forEach(function(e){new Function(e).apply(window)})},t.addCustomStyles=function(){l.log("Adding custom styles ("+u.customStyles.length+")"),u.customStyles.forEach(function(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)})},t.ifid=function(){return u.ifid},t.name=function(){return u.name},t.exportedPassages=f,t.startPassage=d,t.passageNamed=function(e){return c.find(function(t){return t.name===e})},t.passageWithId=function(e){return c.find(function(t){return t.id===e})};var r,o=n(4),i=(r=o)&&r.__esModule?r:{default:r},a=n(7),s=n(0);var l=(0,i.default)("story"),u={customScripts:[],customStyles:[]},c=[];function f(){return c}function d(){return c.find(function(e){return e.id===u.startNode})}t.passages=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t){return e.querySelector(t)},t.selectAll=function(e,t){return Array.from(e.querySelectorAll(t))}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);n(46);t.default=class extends r.Component{constructor(e){super(e),this.state={open:void 0===this.props.initiallyOpen||this.props.initiallyOpen}}toggle(){this.setState({open:!this.state.open})}render(){return(0,r.h)("div",{class:"panel"+(this.state.open?" open":"")},(0,r.h)("h2",null,(0,r.h)("button",{onClick:()=>this.toggle()},this.props.title)),this.state.open&&(0,r.h)("div",{class:"content"},this.props.children))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.render=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,a.default)((0,i.default)(e),(0,s.get)("config.template.inserts")||[],(0,s.get)("config.template.modifiers")||[],t)};var r=l(n(60)),o=l(n(84)),i=l(n(94)),a=l(n(96)),s=n(0);function l(e){return e&&e.__esModule?e:{default:e}}t.defaults={"config.template.inserts":r.default,"config.template.modifiers":o.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.init=function(){(0,s.init)(),(0,l.init)(),h=document.querySelector("#page article"),v=document.querySelector("#page #spinner"),g={},["header","footer"].forEach(function(e){g[e]={container:document.querySelector("#page "+e)},["left","center","right"].forEach(function(t){g[e][t]=document.querySelector("#page "+e+" ."+t)})}),o.default.on("state-change",function(e){var t=e.name;return y("trail"===t)}),["change","click"].forEach(function(e){document.body.addEventListener(e,function(e){for(var t=e.target;t;)t.dataset&&Object.keys(t.dataset).some(function(e){return/^cb[A-Z]/.test(e)})&&o.default.emit("dom-"+e.type,t),t=t.parentNode})})},t.changeBody=function(e){(0,d.selectAll)(h,"input").forEach(function(e){e.setAttribute("value",e.value)}),(0,d.selectAll)(h,"select").forEach(function(e){for(var t=0;t<e.options.length;t++)t===e.options.selectedIndex?e.options[t].setAttribute("selected",""):e.options[t].removeAttribute("selected")});var t={x:window.scrollX,y:window.scrollY},n=h.innerHTML,r=document.createElement("div");for(;h.firstChild;)r.insertBefore(h.firstChild,r.firstChild);h.innerHTML=n,e(r),window.scrollX=t.x,window.scrollY=t.y,b(h,r.innerHTML,(0,a.get)("config.body.transition.name"),(0,a.get)("config.body.transition.duration"))};var r=p(n(20)),o=p(n(1)),i=n(64),a=n(0),s=n(66),l=n(69),u=n(6),c=n(11),f=p(n(71));n(72);var d=n(7);function p(e){return e&&e.__esModule?e:{default:e}}var h=void 0,g=void 0,v=void 0,m={crossfade:i.crossfade,fadeInOut:i.fadeInOut,none:i.none};t.defaults={"config.body.transition.name":"crossfade","config.body.transition.duration":"500ms","config.header.left":"","config.header.center":"","config.header.right":"","config.header.transition.name":"none","config.header.transition.duration":"500ms","config.footer.left":"_{story.name}_","config.footer.center":"","config.footer.right":"{restart link}","config.footer.transition.name":"none","config.footer.transition.duration":"500ms"};function b(e,t,n,r){m[n]?m[n](e,t,r):m.none(e,t)}var y=(0,r.default)(function(e){if(e.some(function(e){return e[0]})){var t=(0,a.get)("trail"),n=(0,u.passageNamed)(t[t.length-1]);if(!n)throw new Error('There is no passage named "'+t[t.length-1]+'".');window.scrollTo(0,0),b(h,(0,c.render)(n.source),(0,a.get)("config.body.transition.name"),(0,a.get)("config.body.transition.duration")),(0,f.default)(h,v)}["header","footer"].forEach(function(e){g[e].container.classList.remove("has-content"),["left","center","right"].forEach(function(t){var n=(0,c.render)((0,a.get)("config."+e+"."+t));""!==n&&g[e].container.classList.add("has-content"),b(g[e][t],n,(0,a.get)("config."+e+".transition.name"),(0,a.get)("config."+e+".transition.duration"))})})})},function(e,t,n){"use strict";e.exports=function(e,t,n){n=Object.assign({},r,n||{});let o=0,a=function(e){let t={ms:.001,s:1,m:60,h:3600};return t.d=e.hoursPerDay*t.h,t.w=e.daysPerWeek*t.d,t.mth=e.daysPerYear/e.monthsPerYear*t.d,t.y=e.daysPerYear*t.d,t}(n),s=e.toLowerCase().replace(/[^.\w+-]+/g,"").match(/[-+]?[0-9.]+[a-z]+/g);null!==s&&s.forEach(e=>{let t=e.match(/[0-9.]+/g)[0],n=e.match(/[a-z]+/g)[0];o+=function(e,t,n){return e*n[i(t)]}(t,n,a)});if(t)return function(e,t,n){return e/n[i(t)]}(o,t,a);return o};const r={hoursPerDay:24,daysPerWeek:7,weeksPerMonth:4,monthsPerYear:12,daysPerYear:365.25},o={ms:["ms","milli","millisecond","milliseconds"],s:["s","sec","secs","second","seconds"],m:["m","min","mins","minute","minutes"],h:["h","hr","hrs","hour","hours"],d:["d","day","days"],w:["w","week","weeks"],mth:["mon","mth","mths","month","months"],y:["y","yr","yrs","year","years"]};function i(e){for(let t of Object.keys(o))if(o[t].indexOf(e)>-1)return t;throw new Error(`The unit [${e}] is not supported by timestring`)}},function(e,t){function n(e,t){if(!e)throw new Error(t||"AssertionError")}n.notEqual=function(e,t,r){n(e!=t,r)},n.notOk=function(e,t){n(!e,t)},n.equal=function(e,t,r){n(e==t,r)},n.ok=n,e.exports=n},function(e,t,n){"use strict";
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderLink=a,t.default=function(e){return e.replace(/\[\[(.*?)\]\]/g,function(e,t){var n=t,r=t.indexOf("|");if(-1!==r)n=t.substr(0,r),t=t.substr(r+1);else{var o=t.indexOf("->");if(-1!==o)n=t.substr(0,o),t=t.substr(o+2);else{var i=t.indexOf("<-");-1!==i&&(n=t.substr(i+2),t=t.substr(0,i))}}return a(t,n||t)})};var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};function a(e,t){return/^\w+:\/\/\/?\w/i.test(e)?(0,i.default)("a",{href:e},[t||e]):(0,i.default)("a",{href:"javascript:void(0)","data-cb-go":e},[t||e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.history=t.defaults=void 0,t.rewindTo=function(e){if(!s[e])throw new Error("There is no history at index "+e+" to rewind to.");l=!1,(0,a.restoreFromObject)(s[e].state),s.length=e+1,l=!0,i.default.emit("backstage-recorder-update")},t.init=function(){i.default.on("state-change",c),i.default.on("state-reset",u)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(0);t.defaults={"config.backstage.trail.maxLength":100};var s=t.history=[],l=!0;function u(){l&&(t.history=s=[],i.default.emit("backstage-recorder-update"))}function c(e){var t=e.name,n=e.value;l&&(s.length===(0,a.get)("config.backstage.trail.maxLength")&&s.shift(),s.push({change:{name:t,value:n},state:(0,a.saveToObject)()}),i.default.emit("backstage-recorder-update"))}},function(e,t,n){(function(t){var n=1/0,r="[object Symbol]",o=/[&<>"'`]/g,i=RegExp(o.source),a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,l=a||s||Function("return this")();var u,c=(u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},function(e){return null==u?void 0:u[e]}),f=Object.prototype.toString,d=l.Symbol,p=d?d.prototype:void 0,h=p?p.toString:void 0;function g(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==r}(e))return h?h.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}e.exports=function(e){var t;return(e=null==(t=e)?"":g(t))&&i.test(e)?e.replace(o,c):e}}).call(this,n(19))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[],n=!1;return function(){for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];n||(n=!0,Promise.resolve().then(function(){try{e(t)}catch(e){window.setTimeout(function(){throw e},0)}t=[],n=!1})),t.push(o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="<span"+Object.keys(t).reduce(function(e,n){return e+" "+n+'="'+t[n]+'"'},"")+">",r=n+e.replace(/[\r\n]{2,}/g,"</span>$&"+n)+"</span>";return r=r.replace(/(<span.*?>)\s*(#+)/gi,"$2 $1")}},function(e,t,n){e.exports=function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}var r,o=(function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}e.exports={defaults:{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:t,changeDefaults:function(t){e.exports.defaults=t}}}(r={exports:{}},r.exports),r.exports),i=(o.defaults,o.getDefaults,o.changeDefaults,/[&<>"']/),a=/[&<>"']/g,s=/[<>"']|&(?!#?\w+;)/,l=/[<>"']|&(?!#?\w+;)/g,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=function(e){return u[e]},f=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function d(e){return e.replace(f,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}var p=/(^|[^\[])\^/g,h=/[^\w:]/g,g=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,v={},m=/^[^:]+:\/*[^/]*$/,b=/^([^:]+:)[\s\S]*$/,y=/^([^:]+:\/*[^/]*)[\s\S]*$/;function k(e,t){v[" "+e]||(m.test(e)?v[" "+e]=e+"/":v[" "+e]=w(e,"/",!0));var n=-1===(e=v[" "+e]).indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(b,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(y,"$1")+t:e+t}function w(e,t,n){var r=e.length;if(0===r)return"";for(var o=0;o<r;){var i=e.charAt(r-o-1);if(i!==t||n){if(i===t||!n)break;o++}else o++}return e.substr(0,r-o)}var x={escape:function(e,t){if(t){if(i.test(e))return e.replace(a,c)}else if(s.test(e))return e.replace(l,c);return e},unescape:d,edit:function(e,t){e=e.source||e,t=t||"";var n={replace:function(t,r){return r=(r=r.source||r).replace(p,"$1"),e=e.replace(t,r),n},getRegex:function(){return new RegExp(e,t)}};return n},cleanUrl:function(e,t,n){if(e){var r;try{r=decodeURIComponent(d(n)).replace(h,"").toLowerCase()}catch(e){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}t&&!g.test(n)&&(n=k(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(e){return null}return n},resolveUrl:k,noopTest:{exec:function(){}},merge:function(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},splitCells:function(e,t){var n=e.replace(/\|/g,function(e,t,n){for(var r=!1,o=t;--o>=0&&"\\"===n[o];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n},rtrim:w,findClosingBracket:function(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=e.length,r=0,o=0;o<n;o++)if("\\"===e[o])o++;else if(e[o]===t[0])r++;else if(e[o]===t[1]&&--r<0)return o;return-1},checkSanitizeDeprecation:function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},repeatString:function(e,t){if(t<1)return"";for(var n="";t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}},_=o.defaults,S=x.rtrim,j=x.splitCells,O=x.escape,C=x.findClosingBracket;function M(e,t,n){var r=t.href,o=t.title?O(t.title):null,i=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:n,href:r,title:o,text:i}:{type:"image",raw:n,href:r,title:o,text:O(i)}}var A=function(){function e(e){this.options=e||_}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e,t){var n=this.rules.block.code.exec(e);if(n){var r=t[t.length-1];if(r&&"paragraph"===r.type)return{raw:n[0],text:n[0].trimRight()};var o=n[0].replace(/^ {4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?o:S(o,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],r=function(e,t){var n=e.match(/^(\s+)(?:```)/);if(null===n)return t;var r=n[1];return t.split("\n").map(function(e){var t=e.match(/^\s+/);if(null===t)return e;var n=t[0];return n.length>=r.length?e.slice(r.length):e}).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:r}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var n=t[2].trim();if(/#$/.test(n)){var r=S(n,"#");this.options.pedantic?n=r.trim():r&&!/ $/.test(r)||(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n}}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var n={type:"table",header:j(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(n.header.length===n.align.length){var r,o=n.align.length;for(r=0;r<o;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(o=n.cells.length,r=0;r<o;r++)n.cells[r]=j(n.cells[r],n.header.length);return n}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var n,r,o,i,a,s,l,u,c=t[0],f=t[2],d=f.length>1,p={type:"list",raw:c,ordered:d,start:d?+f.slice(0,-1):"",loose:!1,items:[]},h=t[0].match(this.rules.block.item),g=!1,v=h.length;o=this.rules.block.listItemStart.exec(h[0]);for(var m=0;m<v;m++){if(n=h[m],c=n,m!==v-1){if((i=this.rules.block.listItemStart.exec(h[m+1]))[1].length>o[0].length||i[1].length>3){h.splice(m,2,h[m]+"\n"+h[m+1]),m--,v--;continue}(!this.options.pedantic||this.options.smartLists?i[2][i[2].length-1]!==f[f.length-1]:d===(1===i[2].length))&&(a=h.slice(m+1).join("\n"),p.raw=p.raw.substring(0,p.raw.length-a.length),m=v-1),o=i}r=n.length,~(n=n.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(r-=n.length,n=this.options.pedantic?n.replace(/^ {1,4}/gm,""):n.replace(new RegExp("^ {1,"+r+"}","gm"),"")),s=g||/\n\n(?!\s*$)/.test(n),m!==v-1&&(g="\n"===n.charAt(n.length-1),s||(s=g)),s&&(p.loose=!0),this.options.gfm&&(l=/^\[[ xX]\] /.test(n),u=void 0,l&&(u=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,""))),p.items.push({type:"list_item",raw:c,task:l,checked:u,loose:s,text:n})}return p}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):O(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));var n=t[1].toLowerCase().replace(/\s+/g," ");return{tag:n,raw:t[0],href:t[2],title:t[3]}}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:"table",header:j(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];var r,o=n.align.length;for(r=0;r<o;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(o=n.cells.length,r=0;r<o;r++)n.cells[r]=j(n.cells[r].replace(/^ *\| *| *\| *$/g,""),n.header.length);return n}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e,t){var n=this.rules.block.text.exec(e);if(n){var r=t[t.length-1];return r&&"text"===r.type?{raw:n[0],text:n[0]}:{type:"text",raw:n[0],text:n[0]}}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:O(t[1])}},t.tag=function(e,t,n){var r=this.rules.inline.tag.exec(e);if(r)return!t&&/^<a /i.test(r[0])?t=!0:t&&/^<\/a>/i.test(r[0])&&(t=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:t,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):O(r[0]):r[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var r=S(n.slice(0,-1),"\\");if((n.length-r.length)%2==0)return}else{var o=C(t[2],"()");if(o>-1){var i=0===t[0].indexOf("!")?5:4,a=i+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,a).trim(),t[3]=""}}var s=t[2],l="";if(this.options.pedantic){var u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],l=u[3])}else l=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),M(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:l?l.replace(this.rules.inline._escapes,"$1"):l},t[0])}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(!(r=t[r.toLowerCase()])||!r.href){var o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return M(n,r,n[0])}},t.strong=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.strong.start.exec(e);if(r&&(!r[1]||r[1]&&(""===n||this.rules.inline.punctuation.exec(n)))){t=t.slice(-1*e.length);var o,i="**"===r[0]?this.rules.inline.strong.endAst:this.rules.inline.strong.endUnd;for(i.lastIndex=0;null!=(r=i.exec(t));)if(o=this.rules.inline.strong.middle.exec(t.slice(0,r.index+3)))return{type:"strong",raw:e.slice(0,o[0].length),text:e.slice(2,o[0].length-2)}}},t.em=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.em.start.exec(e);if(r&&(!r[1]||r[1]&&(""===n||this.rules.inline.punctuation.exec(n)))){t=t.slice(-1*e.length);var o,i="*"===r[0]?this.rules.inline.em.endAst:this.rules.inline.em.endUnd;for(i.lastIndex=0;null!=(r=i.exec(t));)if(o=this.rules.inline.em.middle.exec(t.slice(0,r.index+2)))return{type:"em",raw:e.slice(0,o[0].length),text:e.slice(1,o[0].length-1)}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g," "),r=/[^ ]/.test(n),o=/^ /.test(n)&&/ $/.test(n);return r&&o&&(n=n.substring(1,n.length-1)),n=O(n,!0),{type:"codespan",raw:t[0],text:n}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2]}},t.autolink=function(e,t){var n,r,o=this.rules.inline.autolink.exec(e);if(o)return"@"===o[2]?(n=O(this.options.mangle?t(o[1]):o[1]),r="mailto:"+n):(n=O(o[1]),r=n),{type:"link",raw:o[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var r,o;if("@"===n[2])r=O(this.options.mangle?t(n[0]):n[0]),o="mailto:"+r;else{var i;do{i=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(i!==n[0]);r=O(n[0]),o="www."===n[1]?"http://"+r:r}return{type:"link",raw:n[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}},t.inlineText=function(e,t,n){var r,o=this.rules.inline.text.exec(e);if(o)return r=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):O(o[0]):o[0]:O(this.options.smartypants?n(o[0]):o[0]),{type:"text",raw:o[0],text:r}},e}(),E=x.noopTest,P=x.edit,L=x.merge,$={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:E,table:E,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};$.def=P($.def).replace("label",$._label).replace("title",$._title).getRegex(),$.bullet=/(?:[*+-]|\d{1,9}[.)])/,$.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,$.item=P($.item,"gm").replace(/bull/g,$.bullet).getRegex(),$.listItemStart=P(/^( *)(bull)/).replace("bull",$.bullet).getRegex(),$.list=P($.list).replace(/bull/g,$.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+$.def.source+")").getRegex(),$._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",$._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,$.html=P($.html,"i").replace("comment",$._comment).replace("tag",$._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),$.paragraph=P($._paragraph).replace("hr",$.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",$._tag).getRegex(),$.blockquote=P($.blockquote).replace("paragraph",$.paragraph).getRegex(),$.normal=L({},$),$.gfm=L({},$.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),$.gfm.nptable=P($.gfm.nptable).replace("hr",$.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",$._tag).getRegex(),$.gfm.table=P($.gfm.table).replace("hr",$.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",$._tag).getRegex(),$.pedantic=L({},$.normal,{html:P("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",$._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:E,paragraph:P($.normal._paragraph).replace("hr",$.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",$.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var T={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:E,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",strong:{start:/^(?:(\*\*(?=[*punctuation]))|\*\*)(?![\s])|__/,middle:/^\*\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*\*$|^__(?![\s])((?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?)__$/,endAst:/[^punctuation\s]\*\*(?!\*)|[punctuation]\*\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]__(?!_)(?:(?=[punctuation*\s])|$)/},em:{start:/^(?:(\*(?=[punctuation]))|\*)(?![*\s])|_/,middle:/^\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*$|^_(?![_\s])(?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?_$/,endAst:/[^punctuation\s]\*(?!\*)|[punctuation]\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]_(?!_)(?:(?=[punctuation*\s])|$)/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:E,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\s*punctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};T.punctuation=P(T.punctuation).replace(/punctuation/g,T._punctuation).getRegex(),T._blockSkip="\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>",T._overlapSkip="__[^_]*?__|\\*\\*\\[^\\*\\]*?\\*\\*",T._comment=P($._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),T.em.start=P(T.em.start).replace(/punctuation/g,T._punctuation).getRegex(),T.em.middle=P(T.em.middle).replace(/punctuation/g,T._punctuation).replace(/overlapSkip/g,T._overlapSkip).getRegex(),T.em.endAst=P(T.em.endAst,"g").replace(/punctuation/g,T._punctuation).getRegex(),T.em.endUnd=P(T.em.endUnd,"g").replace(/punctuation/g,T._punctuation).getRegex(),T.strong.start=P(T.strong.start).replace(/punctuation/g,T._punctuation).getRegex(),T.strong.middle=P(T.strong.middle).replace(/punctuation/g,T._punctuation).replace(/overlapSkip/g,T._overlapSkip).getRegex(),T.strong.endAst=P(T.strong.endAst,"g").replace(/punctuation/g,T._punctuation).getRegex(),T.strong.endUnd=P(T.strong.endUnd,"g").replace(/punctuation/g,T._punctuation).getRegex(),T.blockSkip=P(T._blockSkip,"g").getRegex(),T.overlapSkip=P(T._overlapSkip,"g").getRegex(),T._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,T._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,T._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,T.autolink=P(T.autolink).replace("scheme",T._scheme).replace("email",T._email).getRegex(),T._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,T.tag=P(T.tag).replace("comment",T._comment).replace("attribute",T._attribute).getRegex(),T._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,T._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,T._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,T.link=P(T.link).replace("label",T._label).replace("href",T._href).replace("title",T._title).getRegex(),T.reflink=P(T.reflink).replace("label",T._label).getRegex(),T.reflinkSearch=P(T.reflinkSearch,"g").replace("reflink",T.reflink).replace("nolink",T.nolink).getRegex(),T.normal=L({},T),T.pedantic=L({},T.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:P(/^!?\[(label)\]\((.*?)\)/).replace("label",T._label).getRegex(),reflink:P(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",T._label).getRegex()}),T.gfm=L({},T.normal,{escape:P(T.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),T.gfm.url=P(T.gfm.url,"i").replace("email",T.gfm._extended_email).getRegex(),T.breaks=L({},T.gfm,{br:P(T.br).replace("{2,}","*").getRegex(),text:P(T.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var z={block:$,inline:T},N=o.defaults,D=z.block,I=z.inline,R=x.repeatString;function q(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function F(e){var t,n,r="",o=e.length;for(t=0;t<o;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}var U=function(){function t(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||N,this.options.tokenizer=this.options.tokenizer||new A,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:D.normal,inline:I.normal};this.options.pedantic?(t.block=D.pedantic,t.inline=I.pedantic):this.options.gfm&&(t.block=D.gfm,this.options.breaks?t.inline=I.breaks:t.inline=I.gfm),this.tokenizer.rules=t}t.lex=function(e,n){var r=new t(n);return r.lex(e)},t.lexInline=function(e,n){var r=new t(n);return r.inlineTokens(e)};var n,r,o,i=t.prototype;return i.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},i.blockTokens=function(e,t,n){var r,o,i,a;for(void 0===t&&(t=[]),void 0===n&&(n=!0),e=e.replace(/^ +$/gm,"");e;)if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.type&&t.push(r);else if(r=this.tokenizer.code(e,t))e=e.substring(r.raw.length),r.type?t.push(r):((a=t[t.length-1]).raw+="\n"+r.raw,a.text+="\n"+r.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.nptable(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),r.tokens=this.blockTokens(r.text,[],n),t.push(r);else if(r=this.tokenizer.list(e)){for(e=e.substring(r.raw.length),i=r.items.length,o=0;o<i;o++)r.items[o].tokens=this.blockTokens(r.items[o].text,[],!1);t.push(r)}else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.def(e)))e=e.substring(r.raw.length),this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.paragraph(e)))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.text(e,t))e=e.substring(r.raw.length),r.type?t.push(r):((a=t[t.length-1]).raw+="\n"+r.raw,a.text+="\n"+r.text);else if(e){var s="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(s);break}throw new Error(s)}return t},i.inline=function(e){var t,n,r,o,i,a,s=e.length;for(t=0;t<s;t++)switch((a=e[t]).type){case"paragraph":case"text":case"heading":a.tokens=[],this.inlineTokens(a.text,a.tokens);break;case"table":for(a.tokens={header:[],cells:[]},o=a.header.length,n=0;n<o;n++)a.tokens.header[n]=[],this.inlineTokens(a.header[n],a.tokens.header[n]);for(o=a.cells.length,n=0;n<o;n++)for(i=a.cells[n],a.tokens.cells[n]=[],r=0;r<i.length;r++)a.tokens.cells[n][r]=[],this.inlineTokens(i[r],a.tokens.cells[n][r]);break;case"blockquote":this.inline(a.tokens);break;case"list":for(o=a.items.length,n=0;n<o;n++)this.inline(a.items[n].tokens)}return e},i.inlineTokens=function(e,t,n,r){var o;void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r=!1);var i,a,s,l=e;if(this.tokens.links){var u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(l));)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,i.index)+"["+R("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,i.index)+"["+R("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;e;)if(a||(s=""),a=!1,o=this.tokenizer.escape(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.tag(e,n,r))e=e.substring(o.raw.length),n=o.inLink,r=o.inRawBlock,t.push(o);else if(o=this.tokenizer.link(e))e=e.substring(o.raw.length),"link"===o.type&&(o.tokens=this.inlineTokens(o.text,[],!0,r)),t.push(o);else if(o=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(o.raw.length),"link"===o.type&&(o.tokens=this.inlineTokens(o.text,[],!0,r)),t.push(o);else if(o=this.tokenizer.strong(e,l,s))e=e.substring(o.raw.length),o.tokens=this.inlineTokens(o.text,[],n,r),t.push(o);else if(o=this.tokenizer.em(e,l,s))e=e.substring(o.raw.length),o.tokens=this.inlineTokens(o.text,[],n,r),t.push(o);else if(o=this.tokenizer.codespan(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.br(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.del(e))e=e.substring(o.raw.length),o.tokens=this.inlineTokens(o.text,[],n,r),t.push(o);else if(o=this.tokenizer.autolink(e,F))e=e.substring(o.raw.length),t.push(o);else if(n||!(o=this.tokenizer.url(e,F))){if(o=this.tokenizer.inlineText(e,r,q))e=e.substring(o.raw.length),s=o.raw.slice(-1),a=!0,t.push(o);else if(e){var c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}throw new Error(c)}}else e=e.substring(o.raw.length),t.push(o);return t},n=t,o=[{key:"rules",get:function(){return{block:D,inline:I}}}],(r=null)&&e(n.prototype,r),o&&e(n,o),t}(),B=o.defaults,H=x.cleanUrl,Z=x.escape,W=function(){function e(e){this.options=e||B}var t=e.prototype;return t.code=function(e,t,n){var r=(t||"").match(/\S*/)[0];if(this.options.highlight){var o=this.options.highlight(e,r);null!=o&&o!==e&&(n=!0,e=o)}return r?'<pre><code class="'+this.options.langPrefix+Z(r,!0)+'">'+(n?e:Z(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:Z(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,n,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,n){var r=t?"ol":"ul",o=t&&1!==n?' start="'+n+'"':"";return"<"+r+o+">\n"+e+"</"+r+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var n=t.header?"th":"td",r=t.align?"<"+n+' align="'+t.align+'">':"<"+n+">";return r+e+"</"+n+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,n){if(null===(e=H(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<a href="'+Z(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>"},t.image=function(e,t,n){if(null===(e=H(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},t.text=function(e){return e},e}(),V=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return""+n},t.image=function(e,t,n){return""+n},t.br=function(){return""},e}(),J=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do{n=e+"-"+ ++r}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n},t.slug=function(e,t){void 0===t&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),G=o.defaults,X=x.unescape,Y=function(){function e(e){this.options=e||G,this.options.renderer=this.options.renderer||new W,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new V,this.slugger=new J}e.parse=function(t,n){var r=new e(n);return r.parse(t)},e.parseInline=function(t,n){var r=new e(n);return r.parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var n,r,o,i,a,s,l,u,c,f,d,p,h,g,v,m,b,y,k="",w=e.length;for(n=0;n<w;n++)switch((f=e[n]).type){case"space":continue;case"hr":k+=this.renderer.hr();continue;case"heading":k+=this.renderer.heading(this.parseInline(f.tokens),f.depth,X(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue;case"code":k+=this.renderer.code(f.text,f.lang,f.escaped);continue;case"table":for(u="",l="",i=f.header.length,r=0;r<i;r++)l+=this.renderer.tablecell(this.parseInline(f.tokens.header[r]),{header:!0,align:f.align[r]});for(u+=this.renderer.tablerow(l),c="",i=f.cells.length,r=0;r<i;r++){for(s=f.tokens.cells[r],l="",a=s.length,o=0;o<a;o++)l+=this.renderer.tablecell(this.parseInline(s[o]),{header:!1,align:f.align[o]});c+=this.renderer.tablerow(l)}k+=this.renderer.table(u,c);continue;case"blockquote":c=this.parse(f.tokens),k+=this.renderer.blockquote(c);continue;case"list":for(d=f.ordered,p=f.start,h=f.loose,i=f.items.length,c="",r=0;r<i;r++)v=f.items[r],m=v.checked,b=v.task,g="",v.task&&(y=this.renderer.checkbox(m),h?v.tokens.length>0&&"text"===v.tokens[0].type?(v.tokens[0].text=y+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&"text"===v.tokens[0].tokens[0].type&&(v.tokens[0].tokens[0].text=y+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:y}):g+=y),g+=this.parse(v.tokens,h),c+=this.renderer.listitem(g,b,m);k+=this.renderer.list(c,d,p);continue;case"html":k+=this.renderer.html(f.text);continue;case"paragraph":k+=this.renderer.paragraph(this.parseInline(f.tokens));continue;case"text":for(c=f.tokens?this.parseInline(f.tokens):f.text;n+1<w&&"text"===e[n+1].type;)f=e[++n],c+="\n"+(f.tokens?this.parseInline(f.tokens):f.text);k+=t?this.renderer.paragraph(c):c;continue;default:var x='Token with "'+f.type+'" type was not found.';if(this.options.silent)return void console.error(x);throw new Error(x)}return k},t.parseInline=function(e,t){t=t||this.renderer;var n,r,o="",i=e.length;for(n=0;n<i;n++)switch((r=e[n]).type){case"escape":o+=t.text(r.text);break;case"html":o+=t.html(r.text);break;case"link":o+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":o+=t.image(r.href,r.title,r.text);break;case"strong":o+=t.strong(this.parseInline(r.tokens,t));break;case"em":o+=t.em(this.parseInline(r.tokens,t));break;case"codespan":o+=t.codespan(r.text);break;case"br":o+=t.br();break;case"del":o+=t.del(this.parseInline(r.tokens,t));break;case"text":o+=t.text(r.text);break;default:var a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}return o},e}(),K=x.merge,Q=x.checkSanitizeDeprecation,ee=x.escape,te=o.getDefaults,ne=o.changeDefaults,re=o.defaults;function oe(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),t=K({},oe.defaults,t||{}),Q(t),n){var r,o=t.highlight;try{r=U.lex(e,t)}catch(e){return n(e)}var i=function(e){var i;if(!e)try{i=Y.parse(r,t)}catch(t){e=t}return t.highlight=o,e?n(e):n(null,i)};if(!o||o.length<3)return i();if(delete t.highlight,!r.length)return i();var a=0;return oe.walkTokens(r,function(e){"code"===e.type&&(a++,setTimeout(function(){o(e.text,e.lang,function(t,n){if(t)return i(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),0==--a&&i()})},0))}),void(0===a&&i())}try{var s=U.lex(e,t);return t.walkTokens&&oe.walkTokens(s,t.walkTokens),Y.parse(s,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ee(e.message+"",!0)+"</pre>";throw e}}return oe.options=oe.setOptions=function(e){return K(oe.defaults,e),ne(oe.defaults),oe},oe.getDefaults=te,oe.defaults=re,oe.use=function(e){var t=K({},e);if(e.renderer&&function(){var n=oe.defaults.renderer||new W,r=function(t){var r=n[t];n[t]=function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=e.renderer[t].apply(n,i);return!1===s&&(s=r.apply(n,i)),s}};for(var o in e.renderer)r(o);t.renderer=n}(),e.tokenizer&&function(){var n=oe.defaults.tokenizer||new A,r=function(t){var r=n[t];n[t]=function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=e.tokenizer[t].apply(n,i);return!1===s&&(s=r.apply(n,i)),s}};for(var o in e.tokenizer)r(o);t.tokenizer=n}(),e.walkTokens){var n=oe.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),n&&n(t)}}oe.setOptions(t)},oe.walkTokens=function(e,t){for(var r,o=n(e);!(r=o()).done;){var i=r.value;switch(t(i),i.type){case"table":for(var a,s=n(i.tokens.header);!(a=s()).done;){var l=a.value;oe.walkTokens(l,t)}for(var u,c=n(i.tokens.cells);!(u=c()).done;)for(var f,d=n(u.value);!(f=d()).done;){var p=f.value;oe.walkTokens(p,t)}break;case"list":oe.walkTokens(i.items,t);break;default:i.tokens&&oe.walkTokens(i.tokens,t)}}},oe.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=K({},oe.defaults,t||{}),Q(t);try{var n=U.lexInline(e,t);return t.walkTokens&&oe.walkTokens(n,t.walkTokens),Y.parseInline(n,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ee(e.message+"",!0)+"</pre>";throw e}},oe.Parser=Y,oe.parser=Y.parse,oe.Renderer=W,oe.TextRenderer=V,oe.Lexer=U,oe.lexer=U.lex,oe.Tokenizer=A,oe.Slugger=J,oe.parse=oe,oe}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.init=function(){(p=document.createElement("div")).setAttribute("hidden",!0),p.dataset.cbSounds="",document.body.appendChild(p),i.default.on("state-change",function(e){var t=e.name,n=e.value,o=(0,s.sameObject)(t,"sound.ambient"),i=(0,s.sameObject)(t,"sound.effect");if(o){var a=(0,s.get)("sound.ambient");a&&Object.keys(a).forEach(function(e){a[e].url&&h(e,a[e].url,!1),a[e].volume&&m(e,a[e].volume),void 0!==a[e].muted&&b(e,a[e].muted),a[e].playing&&g(e,!0).catch(function(t){return f('Could not resume playing ambient sound "'+e+'" ('+t.message+")")})})}if(i){var l=(0,s.get)("sound.effect");l&&Object.keys(l).forEach(function(e){l[e].url&&h(e,l[e].url,!0),l[e].volume&&m(e,l[e].volume),void 0!==l[e].muted&&b(e,l[e].muted),l[e].playing&&g(e,!1).then(function(){return(0,s.set)("sound.effect."+e+".playing",!1)}).catch(function(t){return f('Could not resume playing sound effect "'+e+'" ('+t.message)})})}if(!o&&!i){var u=/^sound\.(ambient|effect)\.(.+?)\.(.+)$/i.exec(t);if(u)switch(u[3].toLowerCase()){case"playing":n?"ambient"===u[1]?g(u[2],!0,(0,r.default)((0,s.get)(u[2]+".transitionDuration")||(0,s.get)("sound.transitionDuration")||"0s","ms")):g(u[2],!1).then(function(){return(0,s.set)(t,!1)}):"ambient"===u[1]?v(u[2],(0,r.default)((0,s.get)(u[2]+".transitionDuration")||(0,s.get)("sound.transitionDuration")||"0s","ms")):v(u[2]);break;case"url":h(u[2],n,"effect"===u[1]);break;case"volume":m(u[2],n)}}})};var r=l(n(13)),o=l(n(4)),i=l(n(1)),a=l(n(99)),s=n(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=(0,o.default)("sound"),c=u.log,f=u.warn,d={},p=void 0;t.defaults={"sound.mute":!1,"sound.volume":1,"sound.transitionDuration":"1s"};function h(e,t,n){d[e]?(d[e].setAttribute("src",t),n?d[e].setAttribute("preload","auto"):d[e].removeAttribute("preload"),c('Updated <audio> element in sound bank for "'+e+'" to use '+t)):(d[e]=document.createElement("audio"),d[e].setAttribute("src",t),n&&d[e].setAttribute("preload","auto"),p.appendChild(d[e]),c('Added new <audio> element to sound bank for "'+e+'" for '+t))}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!d[e])throw new Error("There is no sound loaded named "+e+".");return c('Playing sound "'+e+'" (looping: '+t+")"),n>0&&(d[e].volume=0,(0,a.default)(d[e],1,n)),t?(d[e].loop=!0,d[e].play()):(d[e].loop=!1,new Promise(function(t,n){try{d[e].addEventListener("ended",function n(){d[e].removeEventListener("ended",n),t()}),d[e].play().catch(function(e){return n(e)})}catch(e){n(e)}}))}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!d[e])throw new Error("There is no sound loaded named "+e+".");if(t<=0)d[e].pause(),d[e].currentTime=0;else{var n=d[e].volume;(0,a.default)(d[e],0,t).then(function(){d[e].pause(),d[e].volume=n,d[e].currentTime=0})}}function m(e,t){if(!d[e])throw new Error("There is no sound loaded named "+e+".");if(t<0||t>1)throw new Error("A sound volume must be between 0 and 1.");d[e].volume=t}function b(e,t){if(!d[e])throw new Error("There is no sound loaded named "+e+".");d[e].muted=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.default=function(e){e("random.coinFlip",function(){var e=l();return(0,o.default)(u),e>.5}),e("random.fraction",function(){var e=l();return(0,o.default)(u),e}),[4,5,6,8,10,12,20,25,50,100,1e3].forEach(function(t){e("random.d"+t,function(){var e=1+Math.round(l()*(t-1));return(0,o.default)(u),e})})};var r=s(n(106)),o=s(n(20)),i=s(n(1)),a=n(0);function s(e){return e&&e.__esModule?e:{default:e}}t.defaults={"config.random.seed":function(){return new Date},"config.random.privateState":null};var l=(0,r.default)(new Date,{state:!0});function u(){(0,a.set)("config.random.privateState",l.state())}i.default.on("state-change",function(e){var t=e.name,n=e.value;"config.random.seed"===t&&(l=(0,r.default)(n,{state:!0}))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.style=d,t.init=function(){(0,a.init)(),f.dataset.cbAuthorStyles="",document.head.appendChild(f),o.default.on("state-change",function(e){var t=e.name,n=e.value;if((0,i.sameObject)(t,"config.style.backdrop")&&(u("Setting backdrop color"),d("#backdrop",{"background-color":(0,s.parseColor)((0,i.get)("config.style.backdrop")).color})),(0,i.sameObject)(t,"config.style.page.fork.divider.color")&&(u("Setting fork divider color"),d("#page .fork p a + a",{"border-top-color":(0,s.parseColor)((0,i.get)("config.style.page.fork.divider.color")).color})),(0,i.sameObject)(t,"config.style.page.fork.divider.size")&&(u("Setting fork divider size"),d("#page .fork p a + a",{"border-top-width":(0,i.get)("config.style.page.fork.divider.size")+"px"})),(0,i.sameObject)(t,"config.style.page.fork.divider.style")&&(u("Setting fork divider style"),d("#page .fork p a + a",{"border-top-style":(0,i.get)("config.style.page.fork.divider.style")})),(0,i.sameObject)(t,"config.style.page.style")||(0,i.sameObject)(t,"config.style.page.style.borderColor"))switch(u("Setting page style"),(0,i.get)("config.style.page.style")){case"none":d("#page",{border:"none","box-shadow":"none"});break;case"shadow":d("#page",{border:"none","box-shadow":"0 4px 8px hsla(0, 0%, 0%, 0.25)"});break;case"thick-line":d("#page",{border:"4px solid "+(0,s.parseColor)((0,i.get)("config.style.page.style.borderColor")).color,"box-shadow":"none"});break;case"thin-line":d("#page",{border:"1px solid "+(0,s.parseColor)((0,i.get)("config.style.page.style.borderColor")).color,"box-shadow":"none"})}if((0,i.sameObject)(t,"config.style.page.verticalAlign"))switch(u("Setting page vertical alignment"),(0,i.get)("config.style.page.verticalAlign")){case"top":d("#page article",{"align-items":"flex-start"});break;case"center":d("#page article",{"align-items":"center"});break;case"bottom":d("#page article",{"align-items":"flex-end"})}if(/^config\.style\.page\..*\.((line)?color|font)$/i.test(t)&&p(t,n),(0,i.sameObject)(t,"config.style.page")){["config.style.page","config.style.page.header","config.style.page.footer"].forEach(function(e){var t=(0,i.get)(e);t&&function(e,t){["color","font","lineColor"].forEach(function(n){t[n]&&p(e+"."+n,t[n]),t.link&&(t.link[n]&&p(e+".link."+n,t.link[n]),t.link.active&&t.link.active[n]&&p(e+".link.active."+n,t.link.active[n]))})}(e,t)})}})};var r=l(n(4)),o=l(n(1)),i=n(0),a=n(117),s=n(118);function l(e){return e&&e.__esModule?e:{default:e}}var u=(0,r.default)("style").log,c=(t.defaults={"config.style.backdrop":"gray-0","config.style.page.style":"shadow","config.style.page.style.borderColor":"gray-2","config.style.page.font":"Iowan Old Style/Constantia/Georgia/serif 18","config.style.page.color":"gray-9 on white","config.style.page.fork.divider.color":"gray-3","config.style.page.fork.divider.style":"dashed","config.style.page.fork.divider.size":1,"config.style.page.link.color":"gray-9","config.style.page.link.lineColor":"red-8","config.style.page.link.font":"underline","config.style.page.link.active.color":"red-8 on red-0","config.style.page.verticalAlign":"center","config.style.page.header.font":"16","config.style.page.header.link.font":"small caps","config.style.page.footer.font":"16","config.style.page.footer.link.font":"small caps"},{}),f=document.createElement("style");function d(e,t){c[e]=c[e]||{},Object.assign(c[e],t),function(){f.innerHTML=Object.keys(c).reduce(function(e,t){return e+(n=t,r=c[t],n+"{"+Object.keys(r).sort().reduce(function(e,t){return r[t]?e+t+":"+r[t].toString()+";":e},"")+"}");var n,r},"")}()}function p(e,t){var n="#page",r=e.replace(/^config\.style\.page\./i,"").split(".");switch("header"===r[0].toLowerCase()?(n+=" header",r.shift()):"footer"===r[0].toLowerCase()&&(n+=" footer",r.shift()),"link"===r[0].toLowerCase()&&(n+=" a",r.shift()),"active"===r[0].toLowerCase()&&(n=n+":hover, "+n+":active",r.shift()),r[0].toLowerCase()){case"color":u("Setting color for "+n),d(n,(0,s.parseColor)(t));break;case"linecolor":u("Setting line color for "+n);var o=(0,s.parseColor)(t).color;d(n,{"text-decoration-color":o,"-webkit-text-decoration-color":o});break;case"font":u("Setting font for "+n),d(n,(0,s.parseFont)(t))}}},function(e,t){var n=/-?\d+(\.\d+)?%?/g;e.exports=function(e){return e.match(n)}},function(e,t){e.exports=function(e,t,n){return Math.min(Math.max(e,t),n)}},function(e,t,n){"use strict";var r=n(29),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(44)),i=p(n(59)),a=n(0),s=n(23),l=p(n(100)),u=p(n(116)),c=n(12),f=n(6),d=n(25);function p(e){return e&&e.__esModule?e:{default:e}}n(126),(0,f.loadFromData)(document.querySelector("tw-storydata")),(0,i.default)(),(0,a.init)(),Object.assign(window,{go:r.go,restart:r.restart}),(0,d.init)(),(0,u.default)(),(0,l.default)(),(0,c.init)(),(0,s.init)(),(0,f.init)(),o&&(0,a.get)("config.testing")&&o.init(),!(0,a.get)("config.testing")&&(0,a.canRestoreFromStorage)()&&(0,a.restoreFromStorage)(),(0,f.addCustomStyles)(),(0,f.runCustomScripts)()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.go=f,t.restart=d;var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(0),s=n(4),l=n(6),u=n(43);function c(e){(0,s.log)("actions",e)}function f(e){c('Going to passage "'+e+'"');var t=(0,l.passageNamed)(e);if(!t)throw new Error('There is no passage with the name "'+e+'"');(0,u.transferToState)(),(0,a.set)("trail",(0,a.get)("trail").concat(t.name))}function d(){c("Restarting"),(0,a.reset)(),window.location.reload()}i.default.on("dom-click",function(e){e.dataset.cbGo&&(0,u.validate)().then(function(){return f(e.dataset.cbGo)})}),i.default.on("dom-click",function(e){e.dataset.cbRestart&&d()})},function(e,t,n){var r=n(31),o=n(32),i=n(14);function a(e){if(!(this instanceof a))return new a(e);this._name=e||"nanobus",this._starListeners=[],this._listeners={}}e.exports=a,a.prototype.emit=function(e){i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.emit: eventName should be type string or symbol");for(var t=[],n=1,r=arguments.length;n<r;n++)t.push(arguments[n]);var a=o(this._name+"('"+e.toString()+"')"),s=this._listeners[e];return s&&s.length>0&&this._emit(this._listeners[e],t),this._starListeners.length>0&&this._emit(this._starListeners,e,t,a.uuid),a(),this},a.prototype.on=a.prototype.addListener=function(e,t){return i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.on: eventName should be type string or symbol"),i.equal(typeof t,"function","nanobus.on: listener should be type function"),"*"===e?this._starListeners.push(t):(this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)),this},a.prototype.prependListener=function(e,t){return i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.prependListener: eventName should be type string or symbol"),i.equal(typeof t,"function","nanobus.prependListener: listener should be type function"),"*"===e?this._starListeners.unshift(t):(this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].unshift(t)),this},a.prototype.once=function(e,t){i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.once: eventName should be type string or symbol"),i.equal(typeof t,"function","nanobus.once: listener should be type function");var n=this;return this.on(e,function r(){t.apply(n,arguments);n.removeListener(e,r)}),this},a.prototype.prependOnceListener=function(e,t){i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.prependOnceListener: eventName should be type string or symbol"),i.equal(typeof t,"function","nanobus.prependOnceListener: listener should be type function");var n=this;return this.prependListener(e,function r(){t.apply(n,arguments);n.removeListener(e,r)}),this},a.prototype.removeListener=function(e,t){return i.ok("string"==typeof e||"symbol"==typeof e,"nanobus.removeListener: eventName should be type string or symbol"),i.equal(typeof t,"function","nanobus.removeListener: listener should be type function"),"*"===e?(this._starListeners=this._starListeners.slice(),n(this._starListeners,t)):(void 0!==this._listeners[e]&&(this._listeners[e]=this._listeners[e].slice()),n(this._listeners[e],t));function n(e,t){if(e){var n=e.indexOf(t);return-1!==n?(r(e,n,1),!0):void 0}}},a.prototype.removeAllListeners=function(e){return e?"*"===e?this._starListeners=[]:this._listeners[e]=[]:(this._starListeners=[],this._listeners={}),this},a.prototype.listeners=function(e){var t="*"!==e?this._listeners[e]:this._starListeners,n=[];if(t)for(var r=t.length,o=0;o<r;o++)n.push(t[o]);return n},a.prototype._emit=function(e,t,n,r){if(void 0!==e&&0!==e.length){void 0===n&&(n=t,t=null),t&&(n=void 0!==r?[t].concat(n,r):[t].concat(n));for(var o=e.length,i=0;i<o;i++){var a=e[i];a.apply(a,n)}}}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,o=e.length;if(!(t>=o||0===n)){var i=o-(n=t+n>o?o-t:n);for(r=t;r<i;++r)e[r]=e[r+n];e.length=i}}},function(e,t,n){var r,o=n(33)(),i=n(14);a.disabled=!0;try{r=window.performance,a.disabled="true"===window.localStorage.DISABLE_NANOTIMING||!r.mark}catch(e){}function a(e){if(i.equal(typeof e,"string","nanotiming: name should be type string"),a.disabled)return s;var t=(1e4*r.now()).toFixed()%Number.MAX_SAFE_INTEGER,n="start-"+t+"-"+e;function l(i){var a="end-"+t+"-"+e;r.mark(a),o.push(function(){var o=null;try{var s=e+" ["+t+"]";r.measure(s,n,a),r.clearMarks(n),r.clearMarks(a)}catch(e){o=e}i&&i(o,e)})}return r.mark(n),l.uuid=t,l}function s(e){e&&o.push(function(){e(new Error("nanotiming: performance API unavailable"))})}e.exports=a},function(e,t,n){var r=n(14),o="undefined"!=typeof window;function i(e){this.hasWindow=e,this.hasIdle=this.hasWindow&&window.requestIdleCallback,this.method=this.hasIdle?window.requestIdleCallback.bind(window):this.setTimeout,this.scheduled=!1,this.queue=[]}i.prototype.push=function(e){r.equal(typeof e,"function","nanoscheduler.push: cb should be type function"),this.queue.push(e),this.schedule()},i.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var e=this;this.method(function(t){for(;e.queue.length&&t.timeRemaining()>0;)e.queue.shift()(t);e.scheduled=!1,e.queue.length&&e.schedule()})}},i.prototype.setTimeout=function(e){setTimeout(e,0,{timeRemaining:function(){return 1}})},e.exports=function(){var e;return o?(window._nanoScheduler||(window._nanoScheduler=new i(!0)),e=window._nanoScheduler):e=new i,e}},function(e,t,n){
/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2018, Jon Schlinkert.
 * Released under the MIT License.
 */
const r=n(15);function o(e,t,n){return"function"==typeof n.join?n.join(e):e[0]+t+e[1]}function i(e,t,n){return"function"!=typeof n.isValid||n.isValid(e,t)}function a(e){return r(e)||Array.isArray(e)||"function"==typeof e}e.exports=function(e,t,n){if(r(n)||(n={default:n}),!a(e))return void 0!==n.default?n.default:e;"number"==typeof t&&(t=String(t));const s=Array.isArray(t),l="string"==typeof t,u=n.separator||".",c=n.joinChar||("string"==typeof u?u:".");if(!l&&!s)return e;if(l&&t in e)return i(t,e,n)?e[t]:n.default;let f=s?t:function(e,t,n){if("function"==typeof n.split)return n.split(e);return e.split(t)}(t,u,n),d=f.length,p=0;do{let t=f[p];for("number"==typeof t&&(t=String(t));t&&"\\"===t.slice(-1);)t=o([t.slice(0,-1),f[++p]||""],c,n);if(t in e){if(!i(t,e,n))return n.default;e=e[t]}else{let r=!1,a=p+1;for(;a<d;)if(r=(t=o([t,f[a++]],c,n))in e){if(!i(t,e,n))return n.default;e=e[t],p=a-1;break}if(!r)return n.default}}while(++p<d&&a(e));return p===d?e:n.default}},function(e,t,n){"use strict";
/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2018, Jon Schlinkert.
 * Released under the MIT License.
 */const r=n(36);function o(e,t,n,r){if(!s(e))return e;let l=r||{};const u=Array.isArray(t);if(!u&&"string"!=typeof t)return e;let c=l.merge;c&&"function"!=typeof c&&(c=Object.assign);const f=(u?t:function(e,t){const n=function(e,t){let n=e;if(void 0===t)return n+"";const r=Object.keys(t);for(let e=0;e<r.length;e++){const o=r[e];n+=";"+o+"="+String(t[o])}return n}(e,t);if(o.memo[n])return o.memo[n];const r=t&&t.separator?t.separator:".";let i=[],a=[];i=t&&"function"==typeof t.split?t.split(e):e.split(r);for(let e=0;e<i.length;e++){let t=i[e];for(;t&&"\\"===t.slice(-1)&&i[e+1];)t=t.slice(0,-1)+r+i[++e];a.push(t)}return o.memo[n]=a,a}(t,l)).filter(a),d=f.length,p=e;if(!r&&1===f.length)return i(e,f[0],n,c),e;for(let t=0;t<d;t++){let r=f[t];if(s(e[r])||(e[r]={}),t===d-1){i(e,r,n,c);break}e=e[r]}return p}function i(e,t,n,o){o&&r(e[t])&&r(n)?e[t]=o({},e[t],n):e[t]=n}function a(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}function s(e){return null!==e&&("object"==typeof e||"function"==typeof e)}o.memo={},e.exports=o},function(e,t,n){"use strict";
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=n(15);function o(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,n;return!1!==o(e)&&("function"==typeof(t=e.constructor)&&(!1!==o(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))}},function(e,t,n){"use strict";
/*!
 * unset-value <https://github.com/jonschlinkert/unset-value>
 *
 * Copyright (c) 2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=n(15),o=n(38);e.exports=function(e,t){if(!r(e))throw new TypeError("expected an object.");if(e.hasOwnProperty(t))return delete e[t],!0;if(o(e,t)){for(var n=t.split("."),i=n.pop();n.length&&"\\"===n[n.length-1].slice(-1);)i=n.pop().slice(0,-1)+"."+i;for(;n.length;)e=e[t=n.shift()];return delete e[i]}return!0}},function(e,t,n){"use strict";
/*!
 * has-value <https://github.com/jonschlinkert/has-value>
 *
 * Copyright (c) 2014-2016, Jon Schlinkert.
 * Licensed under the MIT License.
 */var r=n(39),o=n(41),i=n(42);e.exports=function(e,t,n){return r(e)?o(i(e,t),n):o(e,t)}},function(e,t,n){"use strict";
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var r=n(40);e.exports=function(e){return null!=e&&"object"==typeof e&&!1===r(e)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";
/*!
 * has-values <https://github.com/jonschlinkert/has-values>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */e.exports=function(e,t){if(null==e)return!1;if("boolean"==typeof e)return!0;if("number"==typeof e)return 0!==e||!0!==t;if(void 0!==e.length)return 0!==e.length;for(var n in e)if(e.hasOwnProperty(n))return!0;return!1}},function(e,t){function n(e){return e?Array.isArray(e)?e.join("."):e:""}
/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */
e.exports=function(e,t,r,o,i){if(null===(a=e)||"object"!=typeof a&&"function"!=typeof a||!t)return e;var a;if(t=n(t),r&&(t+="."+n(r)),o&&(t+="."+n(o)),i&&(t+="."+n(i)),t in e)return e[t];for(var s=t.split("."),l=s.length,u=-1;e&&++u<l;){for(var c=s[u];"\\"===c[c.length-1];)c=c.slice(0,-1)+"."+s[++u];e=e[c]}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=function(){var e=document.querySelector("form#cb-validation"),t=(0,r.selectAll)(e,"input, select");return new Promise(function(n,r){var o=function n(){e.removeEventListener("submit",i),t.forEach(function(e){return e.removeEventListener("invalid",n)}),r()},i=function r(){e.removeEventListener("submit",r),t.forEach(function(e){return e.removeEventListener("invalid",o)}),n()};t.forEach(function(e){return e.addEventListener("invalid",o)}),e.addEventListener("submit",i),document.querySelector("button#cb-validation-tester").click()})},t.transferToState=function(){(0,r.selectAll)(document,"[data-cb-set]").forEach(function(e){var t=e.dataset.set;switch(e.nodeName){case"INPUT":(0,o.set)(t,e.value);break;case"SELECT":(0,o.set)(t,e.options[e.selectedIndex].value);break;default:(0,o.set)(t,e.textContent)}})};var r=n(7),o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Backstage=void 0,t.init=function(){(0,o.init)(),(0,r.render)((0,r.h)(f,null),document.body)};var r=n(2),o=n(17),i=c(n(45)),a=c(n(48)),s=c(n(49)),l=c(n(52)),u=c(n(56));function c(e){return e&&e.__esModule?e:{default:e}}n(58);class f extends r.Component{constructor(e){super(e),this.state={open:!0}}setBodyClass(){this.state.open?document.body.classList.add("backstage-visible"):document.body.classList.remove("backstage-visible")}toggle(){this.setState({open:!this.state.open})}render(){const e=this.state.open?{icon:"→",text:"Close"}:{icon:"←",text:"Open"};return(0,r.h)("div",{id:"backstage",class:this.state.open&&"open"},(0,r.h)("button",{onClick:e=>this.toggle(),title:e.text+" backstage panel",class:"toggle-visibility"},e.icon),(0,r.h)(u.default,null,(0,r.h)(s.default,{label:"State"}),(0,r.h)(i.default,{label:"History"}),(0,r.h)(l.default,{label:"Style"}),(0,r.h)(a.default,{label:"Notes"})))}componentDidMount(){this.setBodyClass()}componentDidUpdate(){this.setBodyClass()}}t.Backstage=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=l(n(10)),i=l(n(1)),a=n(17),s=n(0);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if(0===e.length)return[];const t=[];let n,r=[];return e.forEach(({change:e},o)=>{"trail"===e.name?(t.push({historyIndex:o-1,passage:n,varChanges:r}),r=[],n=e.value[e.value.length-1]):r.push({name:e.name,value:e.value})}),t.push({historyIndex:e.length-1,passage:n,varChanges:r}),console.log("Parsed",e,t),t}function c({historyIndex:e,passage:t,varChanges:n}){const o=[(0,r.h)("tr",null,(0,r.h)("td",{class:"actions",rowspan:n.length+1},(0,r.h)("button",{onClick:e>=0?()=>(0,a.rewindTo)(e):s.reset},"↪")),(0,r.h)("td",{class:"go",rowspan:n.length+1,colspan:n.length>0?1:2},t?`Go to "${t}"`:"Startup"))];return n.forEach(e=>{o.push((0,r.h)("tr",null,(0,r.h)("td",null,e.name," ← ",JSON.stringify(e.value))))}),o}n(47);t.default=class extends r.Component{constructor(e){super(e),this.state={history:u(a.history)},this.updateBound=(()=>this.update())}update(){this.setState({history:u(a.history)})}render(){let e;return e=this.state.history.length>0?(0,r.h)("table",{class:"history"},this.state.history.map(c)):(0,r.h)("table",{class:"history"},(0,r.h)("tr",null,(0,r.h)("td",{class:"actions"},(0,r.h)("button",{onClick:s.reset},"↪")),(0,r.h)("td",{class:"go"},"Startup"))),(0,r.h)(o.default,{title:"History"},e)}componentDidMount(){i.default.on("backstage-recorder-update",this.updateBound)}componentDidUnmount(){i.default.removeEventListener("backstage-recorder-update",this.updateBound)}}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(18)),o=n(2),i=l(n(1)),a=n(7),s=n(0);function l(e){return e&&e.__esModule?e:{default:e}}t.default=class extends o.Component{constructor(e){super(e);const t=(0,s.get)("trail");this.state={currentPassage:t[t.length-1],notes:{}},this.restore(),this.syncBound=(e=>this.sync(e))}sync({name:e,value:t}){"trail"===e&&this.setState({currentPassage:t[t.length-1]})}restore(){const e=window.localStorage.getItem(`cb-passage-notes-${(0,s.get)("config.state.saveKey")}`);e&&this.setState({notes:JSON.parse(e)})}save(){window.localStorage.setItem(`cb-passage-notes-${(0,s.get)("config.state.saveKey")}`,JSON.stringify(this.state.notes))}saveNote(e,t){const n=Object.assign({},this.state.notes);n[e]=t,this.setState({notes:n}),this.save()}export(){const e=Object.keys(this.state.notes).reduce((e,t)=>e+`<li class="note"><span class="passage">${(0,r.default)(t)}</span><pre>${(0,r.default)(this.state.notes[t])}</pre></li>`,""),t=document.createElement("a");t.setAttribute("download",`${(0,s.get)("story.name")} Notes - ${(new Date).toDateString()} ${(new Date).toTimeString()}.html`),t.setAttribute("href","data:text/html;base64,"+window.btoa(`<style>body {font-family: sans-serif}</style><h1>Notes for &ldquo;${(0,r.default)((0,s.get)("story.name"))}&rdquo;</h1><ul data-cb-backstage-notes data-cb-version="${(0,s.get)("engine.version")}">${e}</ul>`)),document.body.appendChild(t),t.click(),document.body.removeChild(t)}startImport(){this.upload.click()}import(e){const t=this.upload.files[0];if(!t)return;const n=new FileReader(t);n.onload=(e=>{const t=document.createElement("div"),n=Object.assign({},this.state.notes);let r=0;t.innerHTML=e.target.result;const o=(0,a.selectAll)(t,"ul[data-cb-backstage-notes] li");0!==o.length?(o.forEach(e=>{const t=(0,a.select)(e,"span.passage"),o=(0,a.select)(e,"pre");t&&o&&(n[t.textContent]=(n[t.textContent]||"")+"\n\n"+o.textContent,r++)}),this.setState({notes:n}),this.save(),window.alert(`${r} note(s) were imported.`)):window.alert("No notes were found in this file.")}),n.readAsText(t)}deleteAll(){window.confirm("Are you sure? This will delete all text entered in the Notes panel of Backstage, and cannot be undone.")&&(this.setState({notes:{}}),this.save())}render(){return(0,o.h)("div",null,(0,o.h)("p",null,(0,o.h)("label",null,"Notes on “",this.state.currentPassage,"”")),(0,o.h)("p",null,(0,o.h)("textarea",{value:this.state.notes[this.state.currentPassage],onInput:e=>this.saveNote(this.state.currentPassage,e.target.value)})),(0,o.h)("p",null,(0,o.h)("button",{onClick:()=>this.export()},"Export All Notes"),(0,o.h)("button",{onClick:()=>this.startImport()},"Import Notes From File"),(0,o.h)("button",{onClick:()=>this.deleteAll()},"Delete All Notes")),(0,o.h)("input",{type:"file",hidden:!0,ref:e=>this.upload=e,onChange:()=>this.import()}))}componentDidMount(){i.default.on("state-change",this.syncBound)}componentDidUnmount(){i.default.removeListener("state-change",this.syncBound)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,r.h)("div",null,(0,r.h)(i.default,null),(0,r.h)(o.default,null))};var r=n(2),o=a(n(50)),i=a(n(51));function a(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(2),i=n(0),a=n(10),s=(r=a)&&r.__esModule?r:{default:r};t.default=class extends o.Component{constructor(e){super(e),this.state={snapshots:[]},this.restore()}addSnapshot(){const e=window.prompt("Enter a name for this snapshot:");e&&this.setState({snapshots:this.state.snapshots.concat({name:e,state:(0,i.saveToObject)()})})}loadSnapshot(e){(0,i.restoreFromObject)(this.state.snapshots[e].state)}deleteSnapshot(e){window.confirm(`Are you sure you want to delete the snapshot "${this.state.snapshots[e].name}"? This cannot be undone.`)&&this.setState({snapshots:this.state.snapshots.filter((t,n)=>n!==e)})}save(){window.localStorage.setItem(`cb-snapshots-${(0,i.get)("config.state.saveKey")}`,JSON.stringify(this.state.snapshots))}restore(){const e=window.localStorage.getItem(`cb-snapshots-${(0,i.get)("config.state.saveKey")}`);e&&this.setState({snapshots:JSON.parse(e)})}render(){const e=this.state.snapshots.map((e,t)=>(0,o.h)("div",{class:"segmented-button block"},(0,o.h)("button",{onClick:()=>this.loadSnapshot(t),title:'Load snapshot "{s.name}"'},e.name),(0,o.h)("button",{onClick:()=>this.deleteSnapshot(t),class:"fixed",title:'Delete snapshot "{s.name}"'},(0,o.h)("strong",null,"×"))));return(0,o.h)(s.default,{title:"Snapshots"},e,(0,o.h)("button",{class:"block",onClick:()=>this.addSnapshot()},"Add Snapshot"))}componentDidUpdate(){this.save()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=s(n(10)),i=n(0),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}t.default=class extends r.Component{constructor(e){super(e),this.state={varNames:[],showDefaults:!1},this.syncBound=(()=>this.syncWithState())}syncWithState(){this.setState({varNames:(0,i.varNames)(this.state.showDefaults)})}onChangeDefaults(e){this.setState({showDefaults:e.target.checked})}onChangeVar(e,t){(0,i.set)(t,JSON.parse(e.target.value))}render(){return(0,r.h)(o.default,{title:"Variables"},(0,r.h)("p",null,(0,r.h)("input",{type:"checkbox",id:"cb-backstage-show-defaults",checked:this.state.showDefaults,onChange:e=>this.onChangeDefaults(e)}),(0,r.h)("label",{for:"cb-backstage-show-defaults"},"Show Defaults")),(0,r.h)("table",null,this.state.varNames.map(e=>(0,r.h)("tr",null,(0,r.h)("td",null,e),(0,r.h)("td",null,(0,r.h)("input",{type:"text",value:JSON.stringify((0,i.get)(e)),onChange:t=>this.onChangeVar(t,e)}))))))}componentWillMount(){this.syncWithState(),a.default.on("state-change",this.syncBound)}componentDidUpdate(e,t){t.showDefaults!==this.state.showDefaults&&this.syncWithState()}componentWillUnmount(){a.default.removeListener("state-change",this.syncBound)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,r.h)("div",null,(0,r.h)(o.default,null),(0,r.h)(i.default,{title:"Page",prefix:"page"}),(0,r.h)(i.default,{title:"Header",prefix:"page.header"}),(0,r.h)(i.default,{title:"Footer",prefix:"page.footer"}))};var r=n(2),o=a(n(53)),i=a(n(54));function a(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0),i=s(n(10)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}const l=["page","page.header","page.footer"].reduce((e,t)=>e.concat([`config.style.${t}.font`,`config.style.${t}.color`,`config.style.${t}.link.font`,`config.style.${t}.link.color`,`config.style.${t}.link.lineColor`,`config.style.${t}.link.active.font`,`config.style.${t}.link.active.color`,`config.style.${t}.link.active.lineColor`]),[]);t.default=class extends r.Component{constructor(e){super(e),this.state=l.reduce((e,t)=>(e[t]=(0,o.get)(t),e),{}),this.onStateChangeBound=(({name:e,value:t})=>this.onStateChange(e,t))}onStateChange(e,t){this.state[e]&&this.setState({[e]:t})}render(){const e=Object.keys(this.state).reduce((e,t)=>{const n=(0,o.get)(t);return n?e+`${t}: ${JSON.stringify(n)}\n`:e},"").trim();return(0,r.h)(i.default,{title:"Config"},(0,r.h)("p",null,(0,r.h)("label",{for:"cb-backstage-style-config"},"Enter this code into your first passage’s vars section to permanently use this style:")),(0,r.h)("p",null,(0,r.h)("textarea",{readonly:!0,id:"cb-backstage-style-config",onClick:e=>e.target.select()},e)))}componentWillMount(){a.default.on("state-change",this.onStateChangeBound)}componentWillUnmount(){a.default.removeListener("state-change",this.onStateChangeBound)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({title:e,prefix:t}){return(0,r.h)(o.default,{title:e,initiallyOpen:!1},(0,r.h)(i.default,{label:"Font",binding:`config.style.${t}.font`}),(0,r.h)(i.default,{label:"Color",binding:`config.style.${t}.color`}),(0,r.h)(i.default,{label:"Link Font",binding:`config.style.${t}.link.font`}),(0,r.h)(i.default,{label:"Link Color",binding:`config.style.${t}.link.color`}),(0,r.h)(i.default,{label:"Link Line Color",binding:`config.style.${t}.link.lineColor`}),(0,r.h)(i.default,{label:"Active Link Font",binding:`config.style.${t}.link.active.font`}),(0,r.h)(i.default,{label:"Active Link Color",binding:`config.style.${t}.link.active.color`}),(0,r.h)(i.default,{label:"Active Link Line Color",binding:`config.style.${t}.link.active.lineColor`}))};var r=n(2),o=a(n(10)),i=a(n(55));function a(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({label:e,binding:t}){return(0,r.h)("p",{class:"input-group"},(0,r.h)("label",{for:`cb-backstage-${t}`},e),(0,r.h)("input",{type:"text",id:`cb-backstage-${t}`,value:(0,o.get)(t),onChange:e=>(0,o.set)(t,e.target.value)}))};var r=n(2),o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);n(57);t.default=class extends r.Component{constructor(e){super(e),this.state={selected:0}}select(e){this.setState({selected:e})}render(){const e=this.props.children.map((e,t)=>(0,r.h)("li",null,(0,r.h)("button",{onClick:()=>this.select(t),class:t===this.state.selected&&"active"},e.attributes.label)));return(0,r.h)("div",null,(0,r.h)("ul",{class:"tabs"},e),(0,r.h)("div",{class:"tab-content"},this.props.children[this.state.selected]))}}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){window.engine={extend:function(e,t){var n=a.get("engine.version"),r=d(e),o=d(n);o[0]<r[0]?f("The current engine version ("+n+") has a lower major version than requested ("+e+"); skipping"):(o[0]>r[0]?f("The current engine version ("+n+") has a higher major version than requested ("+e+"); running code but you may encounter problems"):(o[1]<r[1]&&f("The current engine version ("+n+") has a lower minor version than requested ("+e+"); running code but you may encounter problems"),o[1]===r[1]&&o[2]<r[2]&&f("The current engine version ("+n+") has a lower patch version than requested ("+e+"); running code but you may encounter problems")),t())},event:r.default,log:o.log,render:l.render,state:a,story:s,warn:o.warn}};var r=c(n(1)),o=n(4),i=c(o),a=u(n(0)),s=u(n(6)),l=n(11);function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function c(e){return e&&e.__esModule?e:{default:e}}var f=(0,i.default)("extensibility").warn;function d(e){return e.split(".").map(window.parseInt)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(61)),o=m(n(62)),i=m(n(63)),a=m(n(73)),s=m(n(74)),l=m(n(75)),u=m(n(76)),c=m(n(77)),f=m(n(78)),d=m(n(79)),p=m(n(80)),h=m(n(81)),g=m(n(82)),v=m(n(83));function m(e){return e&&e.__esModule?e:{default:e}}t.default=[r.default,o.default,i.default,a.default,s.default,l.default,u.default,c.default,f.default,d.default,p.default,h.default,g.default,v.default]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default={match:/^(no )?ambient\s+sound/i,render:function(e,t){var n=(0,r.get)("sound.ambient");if(n&&Object.keys(n).forEach(function(t){t!==e&&n[t].playing&&(0,r.set)("sound.ambient."+t+".playing",!1)}),e){var o=(0,r.get)("sound.ambient."+e+".description")||"";return t.volume&&(0,r.set)("sound.ambient."+e+".volume",t.volume),(0,r.set)("sound.ambient."+e+".playing",!0),"<audio>"+o+"</audio>"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=n(0);t.default={match:/^back\s+link/i,render:function(e,t){var n=(0,o.get)("trail");return(0,r.renderLink)(n.length>1?n[n.length-2]:n[0],t.label||"Back")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(0),i=s(n(1)),a=s(n(5));function s(e){return e&&e.__esModule?e:{default:e}}t.default={match:/^cycling\s+link(\s+for)?/i,render:function(e,t){var n=void 0;return e?void 0===(n=(0,o.get)(e))&&((0,o.set)(e,t.choices[0]),n=t.choices[0]):n=t.choices[0],(0,a.default)("a",{href:"javascript:void(0)","data-cb-cycle-set":e||void 0,"data-cb-cycle-choices":JSON.stringify(t.choices)},[n])}},i.default.on("dom-click",function(e){if(e.dataset.cbCycleChoices){var t=JSON.parse(e.dataset.cbCycleChoices),n=t.indexOf(e.textContent)+1;n===t.length&&(n=0),(0,r.changeBody)(function(){return e.textContent=t[n]}),e.dataset.cbCycleSet&&(0,o.set)(e.dataset.cbCycleSet,t[n])}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.none=function(e,t){return new Promise(function(n){e.innerHTML="<div>"+t+"</div>",n()})},t.fadeInOut=function(e,t,n){return new Promise(function(r){var o=e.style.pointerEvents,a=(0,i.default)(n,"s")/2;s(e),e.style.pointerEvents="none";var u=document.createElement("div");if(u.innerHTML=t,u.style.visibility="hidden",u.style.animationDuration=a+"s",u.addEventListener("animationend",function t(){u.removeEventListener("animationend",t),u.className="",u.style.animationDuration=a+"s",e.style.pointerEvents=o,r()}),""!==e.innerHTML.trim()){var c=l(e);c.style.position="absolute",c.style.top="0",c.style.left="0",c.className="fade-out",c.style.animationDuration=a+"s",c.addEventListener("animationend",function e(){c.removeEventListener("animationend",e),c.parentNode.removeChild(c),u.style.visibility="visible",u.className="fade-in"}),e.innerHTML="",e.appendChild(u),e.appendChild(c)}else u.className="fade-in",u.animationDuration=2*a,u.style.visibility="visible",u.className="fade-in",e.appendChild(u)})},t.crossfade=function(e,t,n){return new Promise(function(r){var o=e.style.pointerEvents,a=(0,i.default)(n,"s");s(e),e.style.pointerEvents="none";var u=document.createElement("div");if(u.innerHTML=t,u.className="fade-in",u.style.animationDuration=a+"s",u.addEventListener("animationend",function t(){u.removeEventListener("animationend",t),u.style.animationDuration=null,u.className="",e.style.pointerEvents=o,r()}),""!==e.innerHTML.trim()){var c=l(e);c.style.position="absolute",c.style.top="0",c.style.left="0",c.className="fade-out",c.style.animationDuration=a+"s",c.addEventListener("animationend",function e(){c.removeEventListener("animationend",e),c.style.opacity=.5,c.parentNode.removeChild(c)}),e.innerHTML="",e.appendChild(u),e.appendChild(c)}else e.innerHTML="",e.appendChild(u)})};var r,o=n(13),i=(r=o)&&r.__esModule?r:{default:r},a=n(7);function s(e){"static"===window.getComputedStyle(e).position&&(e.style.position="relative")}function l(e){var t=document.createElement(e.nodeName.toLowerCase());return t.innerHTML=e.innerHTML,t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px",t.setAttribute("aria-hidden",!0),t.style.pointerEvents="none",(0,a.selectAll)(t,"audio").forEach(function(e){return e.parentNode.removeChild(e)}),t}n(65)},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){window.addEventListener("error",s),window.addEventListener("unhandledrejection",function(e){return s(e.reason)})};var r,o=n(67),i=(r=o)&&r.__esModule?r:{default:r},a=n(0);function s(e){try{var t="";t=(t=e.error&&e.error.stack?e.message+"\n\nStack trace:\n"+e.error.stack:e.message+"\n\n[No stack trace available]").replace("\nPlease report this to https://github.com/chjj/marked.","");var n=document.createElement("div"),r=document.querySelector("#page article"),o=(0,a.get)("trail");n.className="error",n.innerHTML="\n\t\t\t<p>\n\t\t\tAn unexpected error has occurred.\n\t\t\t</p>\n\t\t\t<pre>"+((0,a.get)("config.testing")?t:"")+'</pre>\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t\t<a href="javascript:void(0)" '+(o.length>1?"data-cb-back":"data-cb-refresh")+'>Go back</a> to the previous passage.\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<a href="javascript:void(0)" data-cb-hard-restart>Hard restart</a>, clearing all progress and beginning from the start.\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t',n.addEventListener("click",function(e){if((0,i.default)(e.target,"[data-cb-back]",!0)){var t=(0,a.get)("trail");Array.isArray(t)?(0,a.set)("trail",t.slice(0,t.length-1)):window.alert("Sorry, going back was not successful. Please try hard restarting.")}else{if((0,i.default)(e.target,"[data-cb-refresh]",!0))(0,a.set)("trail",[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((0,a.get)("trail"))));else(0,i.default)(e.target,"[data-cb-hard-restart]",!0)&&((0,a.purgeFromStorage)(!0),window.location.reload())}}),r.innerHTML="",r.appendChild(n)}catch(e){console.error(e)}}},function(e,t,n){var r=n(68);e.exports=function(e,t,n){for(var o=n?e:e.parentNode;o&&o!==document;){if(r(o,t))return o;o=o.parentNode}}},function(e,t){var n=Element.prototype,r=n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;e.exports=function(e,t){if(r)return r.call(e,t);for(var n=e.parentNode.querySelectorAll(t),o=0;o<n.length;++o)if(n[o]==e)return!0;return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){var e=window.console.warn,t=document.querySelector("#page .warnings");console.warn=function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];if((0,o.get)("config.testing"))try{t.removeAttribute("hidden"),i.forEach(function(e){var n=document.createElement("li");n.className="warning",n.innerHTML="Warning: "+(0,r.default)(e),t.appendChild(n)})}catch(e){}e.apply(window.console,i)},i.default.on("state-change",function(e){var n=e.name;"trail"===n&&(t.setAttribute("hidden",""),t.innerHTML="")})};var r=a(n(18)),o=n(0),i=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}n(70)},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=Date.now(),r=void 0,o=(0,a.selectAll)(e,"[data-cb-skippable]").map(function(e){return{el:e,delay:1e3*(0,i.default)(window.getComputedStyle(e).animationDelay)}}).sort(function(e,t){return e.delay-t.delay});if(0===o.length)return;function s(){var e=Date.now()-n,t=Object.assign({},o.find(function(t){return t.delay>e}));t?(o.forEach(function(e){e.delay<=t.delay?(e.delay=0,e.el.classList.add("skip-animation")):(e.delay-=t.delay,e.el.style.animationDelay=e.delay+"ms")}),n=Date.now(),window.clearTimeout(r),l()):u()}function l(){r&&window.clearTimeout(r),r=window.setTimeout(u,o[o.length-1].delay)}function u(){t.classList.remove("visible"),document.body.removeEventListener("click",s),document.body.removeEventListener("keyup",s)}t.classList.add("visible"),l(),window.setTimeout(function(){document.body.addEventListener("click",s),document.body.addEventListener("keyup",s)},50)};var r,o=n(13),i=(r=o)&&r.__esModule?r:{default:r},a=n(7)},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^embed\s+flickr(\s+image)?/i,render:function(e,t){return(0,i.default)("img",Object.assign({},t,{src:/img src="(.+?)"/.exec(e)[1]}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^embed\s+image?/i,render:function(e,t){return(0,i.default)("img",Object.assign({},t,{src:e}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(11);t.default={match:/^embed\s+passage(\s+named)?/i,render:function(e){return(0,o.render)((0,r.passageNamed)(e).source)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^embed\s+unsplash(\s+image)?/i,render:function(e,t){return(0,i.default)("img",Object.assign({},t,{src:"https://source.unsplash.com/"+e.replace(/.*\//,"")+"/"+t.width+"x"+t.height}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^embed\s+youtube(\s+video)?/i,render:function(e,t){var n="https://www.youtube-nocookie.com/embed/"+e.replace(/.*\?v=/,"")+"?modestbranding=1&rel=0&controls="+(t.controls?1:0)+"&";return t.autoplay&&(n+="autoplay=1&"),t.loop&&(n+="loop=1&"),(0,i.default)("div",{style:"position: relative; height: 0; padding-bottom: 56.25%; margin-bottom: 1em"},[(0,o.domify)("iframe",{src:n,frameBorder:0,style:"position: absolute; top: 0; left: 0; width: 100%; height: 100%"})])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);t.default={match:/^link\s+to/i,render:function(e,t){return(0,r.renderLink)(e,t.label)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),o=n(0),i=n(5),a=s(i);function s(e){return e&&e.__esModule?e:{default:e}}t.default={match:/^dropdown menu(\s+for)?/i,render:function(e,t){var n=void 0;return e&&void 0===(n=(0,o.get)(e))&&((0,o.set)(e,t.choices[0]),n=t.choices[0]),(0,a.default)("select",{"data-cb-menu-set":e||void 0},t.choices.map(function(t){var r={value:t};return e&&n===t&&(r.selected=""),(0,i.domify)("option",r,[t])}))}},r.default.on("dom-change",function(e){e.dataset.cbMenuSet&&(0,o.set)(e.dataset.cbMenuSet,e.querySelectorAll("option")[e.selectedIndex].value)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^restart\s+link/i,render:function(e,t){return(0,i.default)("a",{href:"javascript:void(0)","data-cb-restart":!0},[t.label||"Restart"])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=l(n(1)),i=l(n(5)),a=n(6),s=n(11);function l(e){return e&&e.__esModule?e:{default:e}}t.default={match:/^reveal\s+link/i,render:function(e,t){return t.text?(0,i.default)("a",{href:"javascript:void(0)","data-cb-reveal-text":t.text},[e]):t.passage?(0,i.default)("a",{href:"javascript:void(0)","data-cb-reveal-passage":t.passage},[e]):void 0}},o.default.on("dom-click",function(e){var t=e.dataset.cbRevealText;if(e.dataset.cbRevealPassage&&(t=(0,a.passageNamed)(e.dataset.cbRevealPassage).source),t){var n=document.createElement("div");n.innerHTML=(0,s.render)(t).trim(),(0,r.changeBody)(function(){var t=n.children.length;if(t>0){var r=document.createElement("span");if(r.innerHTML=n.firstChild.innerHTML,e.parentNode.insertBefore(r,e),n.removeChild(n.firstChild),t>1){for(var o=n.lastChild;n.lastChild;)e.parentNode.parentNode.insertBefore(n.lastChild,e.parentNode.nextSibling);for(;e.nextSibling;)o.insertBefore(e.nextSibling,null)}}e.parentNode.removeChild(e)})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default={match:/^sound\s+effect/i,render:function(e,t){var n=(0,r.get)("sound.effect."+e+".description")||"";return t.volume&&(0,r.set)("sound.effect."+e+".volume",t.volume),(0,r.set)("sound.effect."+e+".playing",!0),"<audio>"+n+"</audio>"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1)),o=n(0),i=a(n(5));function a(e){return e&&e.__esModule?e:{default:e}}t.default={match:/^text\s+input(\s+for)?/i,render:function(e,t){return(0,i.default)("input",{type:"text",value:e?(0,o.get)(e):"","data-cb-text-field-set":e||void 0,required:!1!==t.required?"":void 0})}},r.default.on("dom-change",function(e){e.dataset.cbTextFieldSet&&(0,o.set)(e.dataset.cbTextFieldSet,e.value)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(85)),o=f(n(86)),i=f(n(87)),a=f(n(88)),s=f(n(89)),l=f(n(90)),u=f(n(91)),c=f(n(93));function f(e){return e&&e.__esModule?e:{default:e}}t.default=[r.default,o.default,i.default,a.default,s.default,l.default,u.default,c.default]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(13)),o=i(n(21));function i(e){return e&&e.__esModule?e:{default:e}}t.default={match:/^after\s/i,process:function(e,t){var n=t.invocation,i=(0,r.default)(n.replace(/^after\s/i,""),"ms");e.text=(0,o.default)(e.text,{"data-cb-skippable":"",class:"fade-in",style:"animation-delay: "+i+"ms"})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(21),i=(r=o)&&r.__esModule?r:{default:r};t.default={match:/^align\s+(left|right|center)/i,process:function(e,t){var n=t.invocation.replace(/^align\s+/i,"");e.text=(0,i.default)(e.text,{style:"display: block; text-align: "+n})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={match:/^append$/i,process:function(e){e.startsNewParagraph=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={match:/^if(always|never)?\s|else$|unless\s/i,processRaw:function(e,t){var n=t.invocation,r=t.state,o=n.replace(/\s.*/,"").toLowerCase(),i=void 0;switch("else"!==o&&(i=new Function("return "+n.replace(/.*?\s/,""))),o){case"if":r.conditionEval=i.apply(window);break;case"ifalways":r.conditionEval=!0;break;case"ifnever":r.conditionEval=!1;break;case"unless":r.conditionEval=!i.apply(window);break;case"else":if(void 0===r.conditionEval)throw new Error("There was no matching if modifier for an else modifier.");r.conditionEval=!r.conditionEval}r.conditionEval||(e.text="")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={match:/^continued?|cont('d)?$/i,process:function(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={match:/^css$/i,process:function(e){e.text="<style>"+e.text+"</style>"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(92),i=(r=o)&&r.__esModule?r:{default:r},a=n(0);t.default={match:/^javascript$/i,process:function(e){try{var t=new Function("\n\t\t\t\t\t\tfunction write() { write.__out += write.__join.call(arguments, ''); }\n\t\t\t\t\t\twrite.__out = '';\n\t\t\t\t\t\twrite.__join = Array.prototype.join;\n\t\t\t\t\t\t"+(0,i.default)(e.text)+";\n\t\t\t\t\t\treturn write.__out;\n\t\t\t\t\t");e.text=t.apply(window)}catch(t){if(!(0,a.get)("config.testing"))throw t;var n="unknown error";n=t.error&&t.error.stack?t.error.stack:t.message+"\n[No stack trace available]",e.text='<div class="error">An error occured evaluating:<pre>'+e.text+"</pre><p><pre>"+n+"</pre></p></div>"}}}},function(e,t,n){(function(t){var n=1/0,r="[object Symbol]",o=/&(?:amp|lt|gt|quot|#39|#96);/g,i=RegExp(o.source),a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,l=a||s||Function("return this")();var u,c=(u={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},function(e){return null==u?void 0:u[e]}),f=Object.prototype.toString,d=l.Symbol,p=d?d.prototype:void 0,h=p?p.toString:void 0;function g(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==r}(e))return h?h.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}e.exports=function(e){var t;return(e=null==(t=e)?"":g(t))&&i.test(e)?e.replace(o,c):e}}).call(this,n(19))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={match:/^(note(\s+to\s+self)?|n?b?|todo|fixme)$/i,process:function(e){e.text=""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n={vars:[],blocks:[]},i=e.split(t.varsSep,2),a=void 0,c=void 0;if(2===i.length){s("Detected vars section");var f=r(i,2);a=f[0],c=f[1],(0,o.default)(a).forEach(function(e){if(""!==e.trim()){var t=e.indexOf(":");if(-1!==t){var r=e.substr(0,t).trim(),o=e.substr(t+1).trim(),i={name:r,value:new Function("return ("+o+")")},a=r.match(/\(.+\)/);a?(i.condition=new Function("return ("+a[0]+")"),i.name=(i.name.substr(0,a.index)+i.name.substr(a.index+a[0].length)).trim(),s('Setting variable "'+i.name+'" to "'+o+'" with condition ('+a[0]+")")):s('Setting variable "'+r+'" to "'+o+'" without condition'),n.vars.push(i)}else l('The line "'+e+'" in the vars section is missing a colon. It was ignored.')}})}else s("No vars section detected"),c=i[0];var d=function(e,t){var r=t.trim();""!==r&&(s("Creating '"+e+"' block with content: \""+r+'"'),n.blocks.push({type:e,content:r}))},p=new RegExp(t.modifierPattern),h=0,g=p.exec(c);for(;g;){d("text",c.substring(h,g.index));for(var v=g[1],m="",b=0;b<v.length;b++)switch(v[b]){case'"':for(m+='"',b+=1;b<v.length&&(m+=v[b],'"'!==v[b]||"\\"===v[b-1]);b++);break;case";":d("modifier",m),m="";break;default:m+=v[b]}d("modifier",m),h=p.lastIndex,g=p.exec(c)}return d("text",c.substring(h)),n};var o=i(n(95));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,i(n(4)).default)("parse"),s=a.log,l=a.warn,u={varsSep:/^--$/m,modifierPattern:/^\[([^[].+[^\]])\]$/gm}},function(e,t,n){"use strict";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected a string in the first argument, got "+typeof e);if(!(t&&t.preserveNewlines))return e.split(/\r?\n/);for(var n=e.split(/(\r?\n)/),r=[],o=0;o<n.length;o+=2)r.push(n[o]+(n[o+1]||""));return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.markedOptions=void 0,t.default=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.vars)throw new Error("The renderer was given an object with no vars property.");if(!e.blocks)throw new Error("The renderer was given an object with no blocks property.");var i="";o||(c("Setting vars ("+e.vars.length+")"),e.vars.forEach(function(e){if(e.condition){var t=e.condition();t?(c('Setting var "'+name+'" (condition is currently true)'),(0,l.set)(e.name,e.value())):c('Not setting var "'+name+'" (condition is currently false)')}else c('Setting var "'+name+'"'),(0,l.set)(e.name,e.value())}));var u=[],d={};return e.blocks.forEach(function(e){switch(e.type){case"text":var r={text:e.content,startsNewParagraph:!0},o=u.filter(function(e){return!!e.mod.processRaw});c("Running "+o.length+" modifiers on raw source block"),o.forEach(function(e){e.mod.processRaw(r,{state:d[e.mod],invocation:e.invocation})}),r.text=(0,a.default)((0,s.default)(r.text),t);var l=u.filter(function(e){return!!e.mod.process});c("Running "+l.length+" modifiers on source block"),l.forEach(function(e){return e.mod.process(r,{state:d[e.mod],invocation:e.invocation})}),c("Output after modifiers: "+JSON.stringify(r)),""!==r.text.trim()&&(""!==i&&(i+=r.startsNewParagraph?"\n\n":" "),i+=r.text),u=[];break;case"modifier":var f=n.filter(function(t){return t.match.test(e.content)});if(1===f.length){var p=f[0];c('Activated "'+p.name+'" modifier matching ['+e.content+"]"),d[p]=d[p]||{},u.push({mod:p,invocation:e.content})}else 0===f.length?i+="\n\n["+e.content+"]\n\n":(console.warn('More than one modifier matched "['+e.content+']".'),i+="\n\n["+e.content+"]\n\n");break;default:throw new Error("Don't know how to render a block with type \""+e.type+'".')}}),i=i.replace(/^((>|-|\*).*$)\n+\2/gm,"$1\n$2"),r.default.setOptions(f),c("Final Markdown:\n"+i),(0,r.default)(i)};var r=u(n(22)),o=u(n(4)),i=u(n(97)),a=u(n(98)),s=u(n(16)),l=n(0);function u(e){return e&&e.__esModule?e:{default:e}}var c=(0,o.default)("render").log,f=t.markedOptions={renderer:i.default,smartypants:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22);var i=new((r=o)&&r.__esModule?r:{default:r}).default.Renderer;Object.assign(i,{blockquote:function(e){return'<div class="fork">'+e+"</div>"},del:function(e){return'<span class="small-caps">'+e+"</span>"}}),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n="",r=0,i=e.indexOf("{");if(-1===i)return e;for(var a=!1,s=void 0,l=i+1;l<e.length;l++)switch(e[l]){case"{":i=l,a=!1;break;case'"':case"'":l>0&&"\\"!==e[l-1]&&(a?a&&s===e[l]&&(a=!1):(a=!0,s=e[l]));break;case"}":if(!a){var u=e.substring(i,l+1),c="";try{c=o(u,t)}catch(e){console.warn('An error occurred while rendering "'+u+'": '+e.message),c=u}void 0===c&&(c=""),n+=e.substring(r,i)+c,r=l+1,-1===(i=e.indexOf("{",r))&&(l=e.index)}}return n+e.substring(r)};var r=n(0);function o(e,t){var n=e.substr(1,e.length-2).trim();if(/\s/.test(n)){var o=n.match(/^[^:,]+/)[0],i=t.find(function(e){return e.match.test(o)});if(i){var a=n.replace(o,"");if(":"===a[0]){var s=new Function('return {"'+o+'" '+a+"}")(),l=s[o];return delete s[o],i.render(l,s,n)}if(","===a[0]){var u=new Function("return {"+a.substr(1)+"}")();return i.render(null,u,n)}if(""===a)return i.render(null,{},n)}}else{var c=/(.+)\[(.+)\]$/.exec(n),f=void 0;if(void 0!==(f=c?(0,r.get)(c[1])[c[2]]:(0,r.get)(n)))return f}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e.volume,o=t-r,i=void 0,a=0;return new Promise(function(t){return window.requestAnimationFrame(function(s){i=s,window.requestAnimationFrame(function s(l){a+=l-i;e.volume=function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e+t;return-n/2*(--e*(e-2)-1)+t}(a,r,o,n);a<n?(i=l,window.requestAnimationFrame(s)):t()})})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,r.default)(u.setLookup),(0,o.default)(u.setLookup),(0,i.default)(u.setLookup),(0,a.default)(u.setLookup),(0,s.default)(u.setLookup),(0,l.default)(u.setLookup)};var r=c(n(101)),o=c(n(102)),i=c(n(104)),a=c(n(105)),s=c(n(24)),l=c(n(115)),u=n(0);function c(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("browser.height",function(){return window.innerHeight}),e("browser.online",function(){return window.navigator.onLine}),e("browser.width",function(){return window.innerWidth})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("engine.version",function(){return i.default.version})};var r,o=n(103),i=(r=o)&&r.__esModule?r:{default:r}},function(e){e.exports={name:"Chapbook",author:"Chris Klimas <chris@twinery.org>",description:'A Twine story format emphasizing ease of authoring, multimedia, and playability on many different types of devices. Visit the <a href="https://klembot.github.io/chapbook/guide/">guide</a> for more information.',version:"1.2.1",main:"index.js",license:"MIT",devDependencies:{"@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","babel-core":"^6.26.0","babel-loader":"^7.1.4","babel-preset-env":"^1.6.1","babel-preset-preact":"^1.1.0","child-process-promise":"^2.2.1",cpy:"^7.2.0","cpy-cli":"^2.0.0","cross-env":"^5.2.0","css-loader":"^0.28.11",eslint:"^4.14.0","eslint-config-prettier":"^6.11.0","gitbook-cli":"^2.3.2","html-webpack-plugin":"^3.2.0",husky:"^4.2.5",jest:"^24.7.1","jest-localstorage-mock":"^2.2.0",jsdoc:"^3.6.2","jstransformer-marked":"^1.0.3","lodash.escape":"^4.0.1","mini-css-extract-plugin":"^0.4.0","mock-local-storage":"^1.0.5","node-sass":"^4.12.0","npm-run-all":"^4.1.3",prettier:"^2.0.5",pug:"^2.0.3",rimraf:"^2.6.3","rollup-plugin-uglify":"^3.0.0","sass-loader":"^7.0.3","title-case":"^2.1.1","twine-utils":"^1.2.6","url-loader":"^1.1.2",webpack:"^4.28.2","webpack-cli":"^3.1.2","webpack-dev-server":"^3.1.12",yargs:"^11.0.0"},dependencies:{closest:"^0.0.1","get-value":"^3.0.1","lodash.unescape":"^4.0.1",marked:"^1.2.7",nanobus:"^4.3.3","open-color":"^1.6.3",preact:"^8.2.9","pure-color":"^1.3.0",seedrandom:"^2.4.3","set-value":"^3.0.1","split-lines":"^1.1.0",timestring:"^5.0.0","unset-value":"^1.0.0"},scripts:{start:"webpack-dev-server",build:"npm-run-all --parallel build:main build:micro --serial build:format clean","build:format":"node scripts/build-format.js","build:main":"cross-env NODE_ENV=production webpack","build:micro":"cross-env NODE_ENV=production CHAPBOOK_MICRO=y webpack",clean:"rimraf dist/full; rimraf dist/micro",examples:"node scripts/build-examples.js",guide:"gitbook serve guide","guide:init":"cd guide && gitbook install && cd ..","guide:release":"cd guide && gitbook build",lint:"eslint src/",prettier:'prettier --write "src/**/*.{js,scss}"',release:"run-s -l build examples guide:release website",test:"jest","test:watch":"jest --watch","test:coverage":"jest --coverage",website:"node scripts/build-website.js"},config:{commitizen:{path:"cz-conventional-changelog"}},husky:{hooks:{"commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},jest:{setupFiles:["jest-localstorage-mock"]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("now.second",function(){return(new Date).getSeconds()}),e("now.minute",function(){return(new Date).getMinutes()}),e("now.hour",function(){return(new Date).getHours()}),e("now.day",function(){return(new Date).getDate()}),e("now.weekday",function(){return(new Date).getDay()+1}),e("now.weekdayName",function(){return(new Date).toLocaleString(navigator.language,{weekday:"long"})}),e("now.month",function(){return(new Date).getMonth()+1}),e("now.monthName",function(){return(new Date).toLocaleString(navigator.language,{month:"long"})}),e("now.year",function(){return(new Date).getFullYear()}),e("now.timestamp",function(){return(new Date).toLocaleString(navigator.language,{hour:"numeric",minute:"numeric",second:"numeric"})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("passage.name",function(){var e=(0,r.get)("trail");if(e)return e[e.length-1]}),e("passage.visits",function(){var e=(0,r.get)("trail"),t=(0,r.get)("passage.name");if(e)return e.reduce(function(e,n){return n===t?e+1:e},0)})};var r=n(0)},function(e,t,n){var r=n(107),o=n(108),i=n(109),a=n(110),s=n(111),l=n(112),u=n(113);u.alea=r,u.xor128=o,u.xorwow=i,u.xorshift7=a,u.xor4096=s,u.tychei=l,e.exports=u},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var n=new a(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.alea=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xor128=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xorwow=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xorshift7=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),o=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=s[127&i]^=r+a)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=a,e.X=s,e.i=o}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xor4096=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(3)&&n(9)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.tychei=l}(0,e,n(3))}).call(this,n(8)(e))},function(e,t,n){var r;!function(o,i){var a,s=(0,eval)("this"),l=256,u=6,c="random",f=i.pow(l,u),d=i.pow(2,52),p=2*d,h=l-1;function g(e,t,n){var r=[],h=b(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(o)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(l):(e=new Uint8Array(l),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(e){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(o)]}}():e,3),r),g=new v(r),k=function(){for(var e=g.g(u),t=f,n=0;e<d;)e=(e+n)*l,t*=l,n=g.g(1);for(;e>=p;)e/=2,t/=2,n>>>=1;return(e+n)/t};return k.int32=function(){return 0|g.g(4)},k.quick=function(){return g.g(4)/4294967296},k.double=k,b(y(g.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,g),e.state=function(){return m(g,{})}),n?(i[c]=e,t):e})(k,h,"global"in t?t.global:this==i,t.state)}function v(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);o<l;)a[o]=o++;for(o=0;o<l;o++)a[o]=a[i=h&i+e[o%n]+(t=a[o])],a[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,a=r.S;e--;)t=a[o=h&o+1],n=n*l+a[h&(a[o]=a[i=h&i+t])+(a[i]=t)];return r.i=o,r.j=i,n})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function b(e,t){for(var n,r=e+"",o=0;o<r.length;)t[h&o]=h&(n^=19*t[h&o])+r.charCodeAt(o++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i["seed"+c]=g,b(i.random(),o),e.exports){e.exports=g;try{a=n(114)}catch(e){}}else void 0===(r=function(){return g}.call(t,n,t,e))||(e.exports=r)}([],Math)},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("story.name",r.name)};var r=n(6)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){[r.defaults,o.defaults,i.defaults,a.defaults,s.defaults,l.defaults,u.defaults].forEach(function(e){return Object.keys(e).forEach(function(t){"function"==typeof e[t]?(0,s.setDefault)(t,e[t]()):(0,s.setDefault)(t,e[t])})})};var r=n(12),o=n(4),i=n(24),a=n(23),s=n(0),l=n(25),u=n(11)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){l.dataset.cbGoogleFontLoader="",l.setAttribute("hidden",!0),u.dataset.cbTypekitFontLoader="",u.setAttribute("hidden",!0),c.dataset.cbUrlFontLoader="",c.setAttribute("hidden",!0),document.body.appendChild(l),document.body.appendChild(u),document.body.appendChild(c),o.default.on("state-change",function(e){var t=e.name,n="config"===t||"config.style"===t||"config.style.fonts"===t;if(n){var r=(0,i.get)("config.style.fonts");if(!r)return;Object.keys(r).forEach(function(e){var t=r[e].name,n=r[e].url;t&&n&&d(e,n,t)})}else{var o=t.match(/^config\.style\.fonts\.([^.]+)/i);if(o){var a=o[1],c=(0,i.get)("config.style.fonts."+a+".name"),f=(0,i.get)("config.style.fonts."+a+".url");return void(f&&c&&(s("Adding font from URL ("+c+")"),d(a,f,c)))}}(0,i.sameObject)(t,"config.style.googleFont")&&(s("Adding Google font"),l.innerHTML=(0,i.get)("config.style.googleFont")),(0,i.sameObject)(t,"config.style.typekitFont")&&(s("Adding Typekit font"),u.innerHTML=(0,i.get)("config.style.typekitFont"))})};var r=a(n(4)),o=a(n(1)),i=n(0);function a(e){return e&&e.__esModule?e:{default:e}}var s=(0,r.default)("style").log,l=document.createElement("div"),u=document.createElement("div"),c=document.createElement("div"),f={};function d(e,t,n){var r=t.match(/\.(.+)$/);if(r&&r[1]){var o=r[1],i=f[e]||document.createElement("style");i.dataset.cbFontLoader=e,i.innerHTML='@font-face { font-family: "'+n+'"; src: url("'+t+'") format("'+o+'"); }',i.parentNode||c.appendChild(i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autopx=function(e){if("number"==typeof e)return e+"px";return e},t.parseColorValue=s,t.parseColor=function(e){if(void 0===e)return{"background-color":"inherit",color:"inherit"};if("string"!=typeof e)throw new Error("Only strings can be parsed as colors.");var t={color:"inherit","background-color":"inherit"},n=e.split(/ on /i);t.color=s(n[0].trim().toLowerCase()),2===n.length&&(t["background-color"]=s(n[1].trim().toLowerCase()));return t},t.parseFont=function(e){var t={"font-family":"inherit","font-size":"inherit","font-style":"inherit","font-weight":"inherit","letter-spacing":"inherit","text-decoration":"inherit","text-transform":"inherit"};if(void 0===e)return t;if("string"!=typeof e)throw new Error("Only strings can be parsed as fonts.");function n(e,t){e["font-family"]=t.split("/").map(function(e){var t=e;return'"'!==t[0]&&(t='"'+t),'"'!==t[t.length-1]&&(t+='"'),t}).join(",")}function r(e){e["font-weight"]="bold"}function o(e){e["font-style"]="italic"}function i(e){e["font-style"]="none",e["font-weight"]="normal",e["letter-spacing"]="normal",e["text-decoration"]="none",e["text-transform"]="none"}function a(e){e["letter-spacing"]="0.075em",e["text-transform"]="uppercase",e["font-size"]&&"inherit"!==e["font-size"]?e["font-size"]="calc(0.7 * "+e["font-size"]+")":e["font-size"]="70%"}function s(e){e["text-decoration"]="underline"}var l=/\b\d+(?:\.\d+)?(ch|cm|ex|in|mm|pc|pt|px|r?em|vh|vmax|vmin|vw|%)?/i.exec(e);if(l){/^\d+$/.test(l[0])?t["font-size"]=l[0]+"px":t["font-size"]=l[0],0!==l.index&&n(t,e.substr(0,l.index).trim());var u=e.substr(l.index);/\bregular\b/i.test(u)?(t["font-style"]="none",t["font-weight"]="normal",t["letter-spacing"]="normal",t["text-decoration"]="none",t["text-transform"]="none"):(/\bbold\b/.test(u)&&r(t),/\bitalics?\b/.test(u)&&o(t),/\bunderlined?/.test(u)&&s(t),/\bsmall caps?\b/.test(u)&&a(t))}else{for(var c=void 0,f=e;c=/(bold|italics?|regular|small caps|underlined?)$/.exec(f);){switch(c[0]){case"bold":r(t);break;case"italic":case"italics":o(t);break;case"regular":i(t);break;case"small caps":a(t);break;case"underline":case"underlined":s(t)}f=f.substr(0,c.index).trim()}""!==f.trim()&&n(t,f)}return t};var r=a(n(119)),o=a(n(120)),i=a(n(125));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("string"!=typeof e)throw new Error("Only strings can be parsed as color values.");r.default[e]&&(e=Array.isArray(r.default[e])?r.default[e][r.default[e].length-1]:r.default[e]);var t=/^(\w+)-(\d)$/.exec(e);t&&r.default[t[1]]&&(e=r.default[t[1]][t[2]]);var n=(0,o.default)(e),a=(0,i.default)(n);return a[3]=void 0!==n[3]?n[3]:1,"hsla("+a[0]+", "+a[1]+"%, "+a[2]+"%, "+a[3]+")"}},function(e){e.exports={white:"#ffffff",black:"#000000",gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]}},function(e,t,n){var r=n(121),o=n(122),i=n(123),a=n(124);var s={"#":o,hsl:function(e){var t=r(e),n=a(t);return 4===t.length&&n.push(t[3]),n},rgb:i};function l(e){for(var t in s)if(0===e.indexOf(t))return s[t](e)}l.rgb=i,l.hsl=r,l.hex=o,e.exports=l},function(e,t,n){var r=n(26),o=n(27);function i(e,t){switch(e=parseFloat(e),t){case 0:return o(e,0,360);case 1:case 2:return o(e,0,100);case 3:return o(e,0,1)}}e.exports=function(e){return r(e).map(i)}},function(e,t){e.exports=function(e){4!==e.length&&5!==e.length||(e=function(e){for(var t="#",n=1;n<e.length;n++){var r=e.charAt(n);t+=r+r}return t}(e));var t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)];if(9===e.length){var n=parseFloat((parseInt(e.substring(7,9),16)/255).toFixed(2));t.push(n)}return t}},function(e,t,n){var r=n(26),o=n(27);function i(e,t){return t<3?-1!=e.indexOf("%")?Math.round(255*o(parseInt(e,10),0,100)/100):o(parseInt(e,10),0,255):o(parseFloat(e),0,1)}e.exports=function(e){return r(e).map(i)}},function(e,t){e.exports=function(e){var t,n,r,o,i,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0==s)return[i=255*l,i,i];t=2*l-(n=l<.5?l*(1+s):l+s-l*s),o=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o}},function(e,t){e.exports=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.min(r,o,i),s=Math.max(r,o,i),l=s-a;return s==a?t=0:r==s?t=(o-i)/l:o==s?t=2+(i-r)/l:i==s&&(t=4+(r-o)/l),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+s)/2,[t,100*(s==a?0:n<=.5?l/(s+a):l/(2-s-a)),100*n]}},function(e,t,n){}]);</script></body></html>